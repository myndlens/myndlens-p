{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":190},"end":{"line":8,"column":69,"index":259}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":260},"end":{"line":9,"column":49,"index":309}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.deleteDigitalSelf = deleteDigitalSelf;\n  exports.getDigitalSelfSize = getDigitalSelfSize;\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoSecureStore = require(_dependencyMap[1], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  /**\n   * Kill Switch — \"Delete my Digital Self.\"\n   *\n   * Wipes the entire on-device PKG, encrypted data, and the AES key from SecureStore.\n   * Irreversible. User must re-onboard after this.\n   */\n\n  const PKG_STORAGE_KEY_PREFIX = 'myndlens_ds_encrypted';\n  const AES_KEY_PREFIX = 'myndlens_ds_aes_key';\n  async function deleteDigitalSelf(userId) {\n    // 1. Delete encrypted PKG from AsyncStorage\n    await AsyncStorage.default.removeItem(`${PKG_STORAGE_KEY_PREFIX}_${userId}`);\n\n    // 2. Delete any other Digital Self keys for this user\n    const allKeys = await AsyncStorage.default.getAllKeys();\n    const dsKeys = allKeys.filter(k => k.startsWith('myndlens_ds_') && k.includes(userId));\n    if (dsKeys.length > 0) await AsyncStorage.default.multiRemove(dsKeys);\n\n    // 3. Delete AES encryption key from hardware-backed SecureStore (Secure Enclave / StrongBox)\n    await SecureStore.deleteItemAsync(`${AES_KEY_PREFIX}_${userId}`);\n\n    // 4. Clear in-memory key cache so next access generates a fresh key\n    // (Accessing the _keyCache from pkg.ts is not possible due to module encapsulation,\n    //  but the next loadPKG call will fail to decrypt old data, returning empty PKG — correct)\n\n    console.log(`[KillSwitch] Digital Self fully wiped for user: ${userId}`);\n  }\n  async function getDigitalSelfSize(userId) {\n    const raw = await AsyncStorage.default.getItem(`${PKG_STORAGE_KEY_PREFIX}_${userId}`);\n    return raw ? raw.length : 0;\n  }\n});","lineCount":64,"map":[[27,2,14,0,"exports"],[27,9,14,0],[27,10,14,0,"deleteDigitalSelf"],[27,27,14,0],[27,30,14,0,"deleteDigitalSelf"],[27,47,14,0],[28,2,33,0,"exports"],[28,9,33,0],[28,10,33,0,"getDigitalSelfSize"],[28,28,33,0],[28,31,33,0,"getDigitalSelfSize"],[28,49,33,0],[29,2,8,0],[29,6,8,0,"_reactNativeAsyncStorageAsyncStorage"],[29,42,8,0],[29,45,8,0,"require"],[29,52,8,0],[29,53,8,0,"_dependencyMap"],[29,67,8,0],[30,2,8,0],[30,6,8,0,"AsyncStorage"],[30,18,8,0],[30,21,8,0,"_interopDefault"],[30,36,8,0],[30,37,8,0,"_reactNativeAsyncStorageAsyncStorage"],[30,73,8,0],[31,2,9,0],[31,6,9,0,"_expoSecureStore"],[31,22,9,0],[31,25,9,0,"require"],[31,32,9,0],[31,33,9,0,"_dependencyMap"],[31,47,9,0],[32,2,9,0],[32,6,9,0,"SecureStore"],[32,17,9,0],[32,20,9,0,"_interopNamespace"],[32,37,9,0],[32,38,9,0,"_expoSecureStore"],[32,54,9,0],[33,2,1,0],[34,0,2,0],[35,0,3,0],[36,0,4,0],[37,0,5,0],[38,0,6,0],[40,2,11,0],[40,8,11,6,"PKG_STORAGE_KEY_PREFIX"],[40,30,11,28],[40,33,11,31],[40,56,11,54],[41,2,12,0],[41,8,12,6,"AES_KEY_PREFIX"],[41,22,12,20],[41,25,12,23],[41,46,12,44],[42,2,14,7],[42,17,14,22,"deleteDigitalSelf"],[42,34,14,39,"deleteDigitalSelf"],[42,35,14,40,"userId"],[42,41,14,54],[42,43,14,71],[43,4,15,2],[44,4,16,2],[44,10,16,8,"AsyncStorage"],[44,22,16,20],[44,23,16,20,"default"],[44,30,16,20],[44,31,16,21,"removeItem"],[44,41,16,31],[44,42,16,32],[44,45,16,35,"PKG_STORAGE_KEY_PREFIX"],[44,67,16,57],[44,71,16,61,"userId"],[44,77,16,67],[44,79,16,69],[44,80,16,70],[46,4,18,2],[47,4,19,2],[47,10,19,8,"allKeys"],[47,17,19,15],[47,20,19,18],[47,26,19,24,"AsyncStorage"],[47,38,19,36],[47,39,19,36,"default"],[47,46,19,36],[47,47,19,37,"getAllKeys"],[47,57,19,47],[47,58,19,48],[47,59,19,49],[48,4,20,2],[48,10,20,8,"dsKeys"],[48,16,20,14],[48,19,20,17,"allKeys"],[48,26,20,24],[48,27,20,25,"filter"],[48,33,20,31],[48,34,20,32,"k"],[48,35,20,33],[48,39,20,37,"k"],[48,40,20,38],[48,41,20,39,"startsWith"],[48,51,20,49],[48,52,20,50],[48,66,20,64],[48,67,20,65],[48,71,20,69,"k"],[48,72,20,70],[48,73,20,71,"includes"],[48,81,20,79],[48,82,20,80,"userId"],[48,88,20,86],[48,89,20,87],[48,90,20,88],[49,4,21,2],[49,8,21,6,"dsKeys"],[49,14,21,12],[49,15,21,13,"length"],[49,21,21,19],[49,24,21,22],[49,25,21,23],[49,27,21,25],[49,33,21,31,"AsyncStorage"],[49,45,21,43],[49,46,21,43,"default"],[49,53,21,43],[49,54,21,44,"multiRemove"],[49,65,21,55],[49,66,21,56,"dsKeys"],[49,72,21,62],[49,73,21,63],[51,4,23,2],[52,4,24,2],[52,10,24,8,"SecureStore"],[52,21,24,19],[52,22,24,20,"deleteItemAsync"],[52,37,24,35],[52,38,24,36],[52,41,24,39,"AES_KEY_PREFIX"],[52,55,24,53],[52,59,24,57,"userId"],[52,65,24,63],[52,67,24,65],[52,68,24,66],[54,4,26,2],[55,4,27,2],[56,4,28,2],[58,4,30,2,"console"],[58,11,30,9],[58,12,30,10,"log"],[58,15,30,13],[58,16,30,14],[58,67,30,65,"userId"],[58,73,30,71],[58,75,30,73],[58,76,30,74],[59,2,31,0],[60,2,33,7],[60,17,33,22,"getDigitalSelfSize"],[60,35,33,40,"getDigitalSelfSize"],[60,36,33,41,"userId"],[60,42,33,55],[60,44,33,74],[61,4,34,2],[61,10,34,8,"raw"],[61,13,34,11],[61,16,34,14],[61,22,34,20,"AsyncStorage"],[61,34,34,32],[61,35,34,32,"default"],[61,42,34,32],[61,43,34,33,"getItem"],[61,50,34,40],[61,51,34,41],[61,54,34,44,"PKG_STORAGE_KEY_PREFIX"],[61,76,34,66],[61,80,34,70,"userId"],[61,86,34,76],[61,88,34,78],[61,89,34,79],[62,4,35,2],[62,11,35,9,"raw"],[62,14,35,12],[62,17,35,15,"raw"],[62,20,35,18],[62,21,35,19,"length"],[62,27,35,25],[62,30,35,28],[62,31,35,29],[63,2,36,0],[64,0,36,1],[64,3]],"functionMap":{"names":["<global>","deleteDigitalSelf","allKeys.filter$argument_0","getDigitalSelfSize"],"mappings":"AAA;OCa;gCCM,uDD;CDW;OGE;CHG"},"hasCjsExports":false},"type":"js/module"}]}