{"dependencies":[{"name":"../config/env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":264},"end":{"line":11,"column":36,"index":300}}],"key":"RGB4LNLgNgEtjcVNHbEAgFn5Y3M=","exportNames":["*"],"imports":1}},{"name":"./auth","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":12,"column":0,"index":301},"end":{"line":12,"column":61,"index":362}}],"key":"bPsbxvG/upGRzIWg1D65yZCgVZE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"MyndLensWSClient\", {\n    enumerable: true,\n    get: function () {\n      return MyndLensWSClient;\n    }\n  });\n  Object.defineProperty(exports, \"wsClient\", {\n    enumerable: true,\n    get: function () {\n      return wsClient;\n    }\n  });\n  var _configEnv = require(_dependencyMap[0], \"../config/env\");\n  var _auth = require(_dependencyMap[1], \"./auth\");\n  /**\n   * WebSocket client — connects to MyndLens BE with auth.\n   *\n   * Protocol:\n   * 1. Connect to WS endpoint\n   * 2. Send AUTH message with token + device_id\n   * 3. Receive AUTH_OK with session_id\n   * 4. Start heartbeat loop\n   * 5. Route incoming messages to handlers\n   */\n\n  class MyndLensWSClient {\n    ws = null;\n    sessionId = null;\n    handlers = new Map();\n    heartbeatTimer = null;\n    heartbeatSeq = 0;\n    reconnectAttempts = 0;\n    maxReconnectAttempts = 5;\n    reconnectDelay = 2000;\n    _isConnected = false;\n    _isAuthenticated = false;\n    _userId = null;\n    get isConnected() {\n      return this._isConnected;\n    }\n    get isAuthenticated() {\n      return this._isAuthenticated;\n    }\n    get currentSessionId() {\n      return this.sessionId;\n    }\n    get userId() {\n      return this._userId;\n    }\n\n    /**\n     * Register a handler for a specific message type.\n     */\n    on(type, handler) {\n      const existing = this.handlers.get(type) || [];\n      existing.push(handler);\n      this.handlers.set(type, existing);\n      // Return unsubscribe function\n      return () => {\n        const handlers = this.handlers.get(type) || [];\n        const idx = handlers.indexOf(handler);\n        if (idx >= 0) handlers.splice(idx, 1);\n      };\n    }\n\n    /**\n     * Connect to the WebSocket server.\n     */\n    async connect() {\n      if (this.ws) {\n        this.disconnect();\n      }\n      return new Promise(async (resolve, reject) => {\n        try {\n          const token = await (0, _auth.getStoredToken)();\n          if (!token) {\n            reject(new Error('No auth token available. Pair device first.'));\n            return;\n          }\n          const deviceId = await (0, _auth.getOrCreateDeviceId)();\n          const wsUrl = _configEnv.ENV.WS_URL;\n          console.log('[WS] Connecting to', wsUrl);\n          this.ws = new WebSocket(wsUrl);\n          this.ws.onopen = () => {\n            console.log('[WS] Connected, sending AUTH');\n            this._isConnected = true;\n            this.reconnectAttempts = 0;\n\n            // Send AUTH message\n            this.send('auth', {\n              token,\n              device_id: deviceId,\n              client_version: '1.0.0'\n            });\n          };\n          this.ws.onmessage = event => {\n            try {\n              const envelope = JSON.parse(event.data);\n              this._routeMessage(envelope, resolve, reject);\n            } catch (err) {\n              console.error('[WS] Failed to parse message:', err);\n            }\n          };\n          this.ws.onclose = event => {\n            console.log('[WS] Closed:', event.code, event.reason);\n            this._cleanup();\n            this._dispatch('session_terminated', {\n              type: 'session_terminated',\n              id: '',\n              timestamp: new Date().toISOString(),\n              payload: {\n                code: event.code,\n                reason: event.reason\n              }\n            });\n\n            // Auto-reconnect if not intentional close\n            if (event.code !== 1000 && this.reconnectAttempts < this.maxReconnectAttempts) {\n              this.reconnectAttempts++;\n              const delay = this.reconnectDelay * this.reconnectAttempts;\n              console.log(`[WS] Reconnecting in ${delay}ms (attempt ${this.reconnectAttempts})`);\n              setTimeout(() => this.connect().catch(console.error), delay);\n            }\n          };\n          this.ws.onerror = error => {\n            console.warn('[WS] Connection error (non-fatal):', error?.type || 'unknown');\n            // Don't reject - let onclose handle reconnection\n          };\n        } catch (err) {\n          reject(err);\n        }\n      });\n    }\n\n    /**\n     * Send a typed message to the server.\n     */\n    send(type, payload = {}) {\n      if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n        console.warn('[WS] Cannot send, not connected');\n        return;\n      }\n      const envelope = {\n        type,\n        id: Math.random().toString(36).substring(2),\n        timestamp: new Date().toISOString(),\n        payload\n      };\n      this.ws.send(JSON.stringify(envelope));\n    }\n\n    /**\n     * Send an execute request (with presence gate on server).\n     */\n    sendExecuteRequest(draftId, touchToken) {\n      this.send('execute_request', {\n        session_id: this.sessionId,\n        draft_id: draftId,\n        touch_token: touchToken || null\n      });\n    }\n\n    /**\n     * Disconnect and cleanup.\n     */\n    disconnect() {\n      this.maxReconnectAttempts = 0; // Prevent auto-reconnect\n      if (this.ws) {\n        this.ws.close(1000, 'Client disconnect');\n      }\n      this._cleanup();\n    }\n\n    // ---- Private ----\n\n    _routeMessage(envelope, resolve, reject) {\n      const {\n        type\n      } = envelope;\n      switch (type) {\n        case 'auth_ok':\n          this.sessionId = envelope.payload.session_id;\n          this._userId = envelope.payload.user_id;\n          this._isAuthenticated = true;\n          this._startHeartbeat(envelope.payload.heartbeat_interval_ms || _configEnv.ENV.HEARTBEAT_INTERVAL_MS);\n          console.log('[WS] Authenticated, session:', this.sessionId);\n          resolve?.();\n          break;\n        case 'auth_fail':\n          console.error('[WS] Auth failed:', envelope.payload.reason);\n          this._isAuthenticated = false;\n          reject?.(new Error(envelope.payload.reason));\n          break;\n        case 'heartbeat_ack':\n          // Heartbeat acknowledged — no action needed\n          break;\n        default:\n          break;\n      }\n\n      // Dispatch to registered handlers\n      this._dispatch(type, envelope);\n    }\n    _dispatch(type, envelope) {\n      const handlers = this.handlers.get(type) || [];\n      for (const handler of handlers) {\n        try {\n          handler(envelope);\n        } catch (err) {\n          console.error(`[WS] Handler error for ${type}:`, err);\n        }\n      }\n    }\n    _startHeartbeat(intervalMs) {\n      this._stopHeartbeat();\n      this.heartbeatSeq = 0;\n      this.heartbeatTimer = setInterval(() => {\n        if (this.ws && this.ws.readyState === WebSocket.OPEN && this.sessionId) {\n          this.heartbeatSeq++;\n          this.send('heartbeat', {\n            session_id: this.sessionId,\n            seq: this.heartbeatSeq,\n            client_ts: new Date().toISOString()\n          });\n        }\n      }, intervalMs);\n      console.log(`[WS] Heartbeat started: ${intervalMs}ms interval`);\n    }\n    _stopHeartbeat() {\n      if (this.heartbeatTimer) {\n        clearInterval(this.heartbeatTimer);\n        this.heartbeatTimer = null;\n      }\n    }\n    _cleanup() {\n      this._stopHeartbeat();\n      this._isConnected = false;\n      this._isAuthenticated = false;\n      this.sessionId = null;\n      this.ws = null;\n    }\n  }\n\n  // Singleton instance\n  const wsClient = new MyndLensWSClient();\n});","lineCount":252,"map":[[7,2,31,0,"Object"],[7,8,31,0],[7,9,31,0,"defineProperty"],[7,23,31,0],[7,24,31,0,"exports"],[7,31,31,0],[8,4,31,0,"enumerable"],[8,14,31,0],[9,4,31,0,"get"],[9,7,31,0],[9,18,31,0,"get"],[9,19,31,0],[10,6,31,0],[10,13,31,0,"MyndLensWSClient"],[10,29,31,0],[11,4,31,0],[12,2,31,0],[13,2,258,0,"Object"],[13,8,258,0],[13,9,258,0,"defineProperty"],[13,23,258,0],[13,24,258,0,"exports"],[13,31,258,0],[14,4,258,0,"enumerable"],[14,14,258,0],[15,4,258,0,"get"],[15,7,258,0],[15,18,258,0,"get"],[15,19,258,0],[16,6,258,0],[16,13,258,0,"wsClient"],[16,21,258,0],[17,4,258,0],[18,2,258,0],[19,2,11,0],[19,6,11,0,"_configEnv"],[19,16,11,0],[19,19,11,0,"require"],[19,26,11,0],[19,27,11,0,"_dependencyMap"],[19,41,11,0],[20,2,12,0],[20,6,12,0,"_auth"],[20,11,12,0],[20,14,12,0,"require"],[20,21,12,0],[20,22,12,0,"_dependencyMap"],[20,36,12,0],[21,2,1,0],[22,0,2,0],[23,0,3,0],[24,0,4,0],[25,0,5,0],[26,0,6,0],[27,0,7,0],[28,0,8,0],[29,0,9,0],[30,0,10,0],[32,2,31,7],[32,8,31,13,"MyndLensWSClient"],[32,24,31,29],[32,25,31,30],[33,4,32,10,"ws"],[33,6,32,12],[33,9,32,33],[33,13,32,37],[34,4,33,10,"sessionId"],[34,13,33,19],[34,16,33,37],[34,20,33,41],[35,4,34,10,"handlers"],[35,12,34,18],[35,15,34,61],[35,19,34,65,"Map"],[35,22,34,68],[35,23,34,69],[35,24,34,70],[36,4,35,10,"heartbeatTimer"],[36,18,35,24],[36,21,35,66],[36,25,35,70],[37,4,36,10,"heartbeatSeq"],[37,16,36,22],[37,19,36,33],[37,20,36,34],[38,4,37,10,"reconnectAttempts"],[38,21,37,27],[38,24,37,38],[38,25,37,39],[39,4,38,10,"maxReconnectAttempts"],[39,24,38,30],[39,27,38,41],[39,28,38,42],[40,4,39,10,"reconnectDelay"],[40,18,39,24],[40,21,39,35],[40,25,39,39],[41,4,40,10,"_isConnected"],[41,16,40,22],[41,19,40,34],[41,24,40,39],[42,4,41,10,"_isAuthenticated"],[42,20,41,26],[42,23,41,38],[42,28,41,43],[43,4,42,10,"_userId"],[43,11,42,17],[43,14,42,35],[43,18,42,39],[44,4,44,2],[44,8,44,6,"isConnected"],[44,19,44,17,"isConnected"],[44,20,44,17],[44,22,44,29],[45,6,44,31],[45,13,44,38],[45,17,44,42],[45,18,44,43,"_isConnected"],[45,30,44,55],[46,4,44,57],[47,4,45,2],[47,8,45,6,"isAuthenticated"],[47,23,45,21,"isAuthenticated"],[47,24,45,21],[47,26,45,33],[48,6,45,35],[48,13,45,42],[48,17,45,46],[48,18,45,47,"_isAuthenticated"],[48,34,45,63],[49,4,45,65],[50,4,46,2],[50,8,46,6,"currentSessionId"],[50,24,46,22,"currentSessionId"],[50,25,46,22],[50,27,46,40],[51,6,46,42],[51,13,46,49],[51,17,46,53],[51,18,46,54,"sessionId"],[51,27,46,63],[52,4,46,65],[53,4,47,2],[53,8,47,6,"userId"],[53,14,47,12,"userId"],[53,15,47,12],[53,17,47,30],[54,6,47,32],[54,13,47,39],[54,17,47,43],[54,18,47,44,"_userId"],[54,25,47,51],[55,4,47,53],[57,4,49,2],[58,0,50,0],[59,0,51,0],[60,4,52,2,"on"],[60,6,52,4,"on"],[60,7,52,5,"type"],[60,11,52,24],[60,13,52,26,"handler"],[60,20,52,51],[60,22,52,65],[61,6,53,4],[61,12,53,10,"existing"],[61,20,53,18],[61,23,53,21],[61,27,53,25],[61,28,53,26,"handlers"],[61,36,53,34],[61,37,53,35,"get"],[61,40,53,38],[61,41,53,39,"type"],[61,45,53,43],[61,46,53,44],[61,50,53,48],[61,52,53,50],[62,6,54,4,"existing"],[62,14,54,12],[62,15,54,13,"push"],[62,19,54,17],[62,20,54,18,"handler"],[62,27,54,25],[62,28,54,26],[63,6,55,4],[63,10,55,8],[63,11,55,9,"handlers"],[63,19,55,17],[63,20,55,18,"set"],[63,23,55,21],[63,24,55,22,"type"],[63,28,55,26],[63,30,55,28,"existing"],[63,38,55,36],[63,39,55,37],[64,6,56,4],[65,6,57,4],[65,13,57,11],[65,19,57,17],[66,8,58,6],[66,14,58,12,"handlers"],[66,22,58,20],[66,25,58,23],[66,29,58,27],[66,30,58,28,"handlers"],[66,38,58,36],[66,39,58,37,"get"],[66,42,58,40],[66,43,58,41,"type"],[66,47,58,45],[66,48,58,46],[66,52,58,50],[66,54,58,52],[67,8,59,6],[67,14,59,12,"idx"],[67,17,59,15],[67,20,59,18,"handlers"],[67,28,59,26],[67,29,59,27,"indexOf"],[67,36,59,34],[67,37,59,35,"handler"],[67,44,59,42],[67,45,59,43],[68,8,60,6],[68,12,60,10,"idx"],[68,15,60,13],[68,19,60,17],[68,20,60,18],[68,22,60,20,"handlers"],[68,30,60,28],[68,31,60,29,"splice"],[68,37,60,35],[68,38,60,36,"idx"],[68,41,60,39],[68,43,60,41],[68,44,60,42],[68,45,60,43],[69,6,61,4],[69,7,61,5],[70,4,62,2],[72,4,64,2],[73,0,65,0],[74,0,66,0],[75,4,67,2],[75,10,67,8,"connect"],[75,17,67,15,"connect"],[75,18,67,15],[75,20,67,33],[76,6,68,4],[76,10,68,8],[76,14,68,12],[76,15,68,13,"ws"],[76,17,68,15],[76,19,68,17],[77,8,69,6],[77,12,69,10],[77,13,69,11,"disconnect"],[77,23,69,21],[77,24,69,22],[77,25,69,23],[78,6,70,4],[79,6,72,4],[79,13,72,11],[79,17,72,15,"Promise"],[79,24,72,22],[79,25,72,23],[79,32,72,30,"resolve"],[79,39,72,37],[79,41,72,39,"reject"],[79,47,72,45],[79,52,72,50],[80,8,73,6],[80,12,73,10],[81,10,74,8],[81,16,74,14,"token"],[81,21,74,19],[81,24,74,22],[81,30,74,28],[81,34,74,28,"getStoredToken"],[81,39,74,42],[81,40,74,42,"getStoredToken"],[81,54,74,42],[81,56,74,43],[81,57,74,44],[82,10,75,8],[82,14,75,12],[82,15,75,13,"token"],[82,20,75,18],[82,22,75,20],[83,12,76,10,"reject"],[83,18,76,16],[83,19,76,17],[83,23,76,21,"Error"],[83,28,76,26],[83,29,76,27],[83,74,76,72],[83,75,76,73],[83,76,76,74],[84,12,77,10],[85,10,78,8],[86,10,80,8],[86,16,80,14,"deviceId"],[86,24,80,22],[86,27,80,25],[86,33,80,31],[86,37,80,31,"getOrCreateDeviceId"],[86,42,80,50],[86,43,80,50,"getOrCreateDeviceId"],[86,62,80,50],[86,64,80,51],[86,65,80,52],[87,10,81,8],[87,16,81,14,"wsUrl"],[87,21,81,19],[87,24,81,22,"ENV"],[87,34,81,25],[87,35,81,25,"ENV"],[87,38,81,25],[87,39,81,26,"WS_URL"],[87,45,81,32],[88,10,83,8,"console"],[88,17,83,15],[88,18,83,16,"log"],[88,21,83,19],[88,22,83,20],[88,42,83,40],[88,44,83,42,"wsUrl"],[88,49,83,47],[88,50,83,48],[89,10,84,8],[89,14,84,12],[89,15,84,13,"ws"],[89,17,84,15],[89,20,84,18],[89,24,84,22,"WebSocket"],[89,33,84,31],[89,34,84,32,"wsUrl"],[89,39,84,37],[89,40,84,38],[90,10,86,8],[90,14,86,12],[90,15,86,13,"ws"],[90,17,86,15],[90,18,86,16,"onopen"],[90,24,86,22],[90,27,86,25],[90,33,86,31],[91,12,87,10,"console"],[91,19,87,17],[91,20,87,18,"log"],[91,23,87,21],[91,24,87,22],[91,54,87,52],[91,55,87,53],[92,12,88,10],[92,16,88,14],[92,17,88,15,"_isConnected"],[92,29,88,27],[92,32,88,30],[92,36,88,34],[93,12,89,10],[93,16,89,14],[93,17,89,15,"reconnectAttempts"],[93,34,89,32],[93,37,89,35],[93,38,89,36],[95,12,91,10],[96,12,92,10],[96,16,92,14],[96,17,92,15,"send"],[96,21,92,19],[96,22,92,20],[96,28,92,26],[96,30,92,28],[97,14,93,12,"token"],[97,19,93,17],[98,14,94,12,"device_id"],[98,23,94,21],[98,25,94,23,"deviceId"],[98,33,94,31],[99,14,95,12,"client_version"],[99,28,95,26],[99,30,95,28],[100,12,96,10],[100,13,96,11],[100,14,96,12],[101,10,97,8],[101,11,97,9],[102,10,99,8],[102,14,99,12],[102,15,99,13,"ws"],[102,17,99,15],[102,18,99,16,"onmessage"],[102,27,99,25],[102,30,99,29,"event"],[102,35,99,34],[102,39,99,39],[103,12,100,10],[103,16,100,14],[104,14,101,12],[104,20,101,18,"envelope"],[104,28,101,38],[104,31,101,41,"JSON"],[104,35,101,45],[104,36,101,46,"parse"],[104,41,101,51],[104,42,101,52,"event"],[104,47,101,57],[104,48,101,58,"data"],[104,52,101,62],[104,53,101,63],[105,14,102,12],[105,18,102,16],[105,19,102,17,"_routeMessage"],[105,32,102,30],[105,33,102,31,"envelope"],[105,41,102,39],[105,43,102,41,"resolve"],[105,50,102,48],[105,52,102,50,"reject"],[105,58,102,56],[105,59,102,57],[106,12,103,10],[106,13,103,11],[106,14,103,12],[106,21,103,19,"err"],[106,24,103,22],[106,26,103,24],[107,14,104,12,"console"],[107,21,104,19],[107,22,104,20,"error"],[107,27,104,25],[107,28,104,26],[107,59,104,57],[107,61,104,59,"err"],[107,64,104,62],[107,65,104,63],[108,12,105,10],[109,10,106,8],[109,11,106,9],[110,10,108,8],[110,14,108,12],[110,15,108,13,"ws"],[110,17,108,15],[110,18,108,16,"onclose"],[110,25,108,23],[110,28,108,27,"event"],[110,33,108,32],[110,37,108,37],[111,12,109,10,"console"],[111,19,109,17],[111,20,109,18,"log"],[111,23,109,21],[111,24,109,22],[111,38,109,36],[111,40,109,38,"event"],[111,45,109,43],[111,46,109,44,"code"],[111,50,109,48],[111,52,109,50,"event"],[111,57,109,55],[111,58,109,56,"reason"],[111,64,109,62],[111,65,109,63],[112,12,110,10],[112,16,110,14],[112,17,110,15,"_cleanup"],[112,25,110,23],[112,26,110,24],[112,27,110,25],[113,12,111,10],[113,16,111,14],[113,17,111,15,"_dispatch"],[113,26,111,24],[113,27,111,25],[113,47,111,45],[113,49,111,47],[114,14,112,12,"type"],[114,18,112,16],[114,20,112,18],[114,40,112,38],[115,14,113,12,"id"],[115,16,113,14],[115,18,113,16],[115,20,113,18],[116,14,114,12,"timestamp"],[116,23,114,21],[116,25,114,23],[116,29,114,27,"Date"],[116,33,114,31],[116,34,114,32],[116,35,114,33],[116,36,114,34,"toISOString"],[116,47,114,45],[116,48,114,46],[116,49,114,47],[117,14,115,12,"payload"],[117,21,115,19],[117,23,115,21],[118,16,115,23,"code"],[118,20,115,27],[118,22,115,29,"event"],[118,27,115,34],[118,28,115,35,"code"],[118,32,115,39],[119,16,115,41,"reason"],[119,22,115,47],[119,24,115,49,"event"],[119,29,115,54],[119,30,115,55,"reason"],[120,14,115,62],[121,12,116,10],[121,13,116,11],[121,14,116,12],[123,12,118,10],[124,12,119,10],[124,16,119,14,"event"],[124,21,119,19],[124,22,119,20,"code"],[124,26,119,24],[124,31,119,29],[124,35,119,33],[124,39,119,37],[124,43,119,41],[124,44,119,42,"reconnectAttempts"],[124,61,119,59],[124,64,119,62],[124,68,119,66],[124,69,119,67,"maxReconnectAttempts"],[124,89,119,87],[124,91,119,89],[125,14,120,12],[125,18,120,16],[125,19,120,17,"reconnectAttempts"],[125,36,120,34],[125,38,120,36],[126,14,121,12],[126,20,121,18,"delay"],[126,25,121,23],[126,28,121,26],[126,32,121,30],[126,33,121,31,"reconnectDelay"],[126,47,121,45],[126,50,121,48],[126,54,121,52],[126,55,121,53,"reconnectAttempts"],[126,72,121,70],[127,14,122,12,"console"],[127,21,122,19],[127,22,122,20,"log"],[127,25,122,23],[127,26,122,24],[127,50,122,48,"delay"],[127,55,122,53],[127,70,122,68],[127,74,122,72],[127,75,122,73,"reconnectAttempts"],[127,92,122,90],[127,95,122,93],[127,96,122,94],[128,14,123,12,"setTimeout"],[128,24,123,22],[128,25,123,23],[128,31,123,29],[128,35,123,33],[128,36,123,34,"connect"],[128,43,123,41],[128,44,123,42],[128,45,123,43],[128,46,123,44,"catch"],[128,51,123,49],[128,52,123,50,"console"],[128,59,123,57],[128,60,123,58,"error"],[128,65,123,63],[128,66,123,64],[128,68,123,66,"delay"],[128,73,123,71],[128,74,123,72],[129,12,124,10],[130,10,125,8],[130,11,125,9],[131,10,127,8],[131,14,127,12],[131,15,127,13,"ws"],[131,17,127,15],[131,18,127,16,"onerror"],[131,25,127,23],[131,28,127,27,"error"],[131,33,127,32],[131,37,127,37],[132,12,128,10,"console"],[132,19,128,17],[132,20,128,18,"warn"],[132,24,128,22],[132,25,128,23],[132,61,128,59],[132,63,128,61,"error"],[132,68,128,66],[132,70,128,68,"type"],[132,74,128,72],[132,78,128,76],[132,87,128,85],[132,88,128,86],[133,12,129,10],[134,10,130,8],[134,11,130,9],[135,8,132,6],[135,9,132,7],[135,10,132,8],[135,17,132,15,"err"],[135,20,132,18],[135,22,132,20],[136,10,133,8,"reject"],[136,16,133,14],[136,17,133,15,"err"],[136,20,133,18],[136,21,133,19],[137,8,134,6],[138,6,135,4],[138,7,135,5],[138,8,135,6],[139,4,136,2],[141,4,138,2],[142,0,139,0],[143,0,140,0],[144,4,141,2,"send"],[144,8,141,6,"send"],[144,9,141,7,"type"],[144,13,141,26],[144,15,141,28,"payload"],[144,22,141,56],[144,25,141,59],[144,26,141,60],[144,27,141,61],[144,29,141,69],[145,6,142,4],[145,10,142,8],[145,11,142,9],[145,15,142,13],[145,16,142,14,"ws"],[145,18,142,16],[145,22,142,20],[145,26,142,24],[145,27,142,25,"ws"],[145,29,142,27],[145,30,142,28,"readyState"],[145,40,142,38],[145,45,142,43,"WebSocket"],[145,54,142,52],[145,55,142,53,"OPEN"],[145,59,142,57],[145,61,142,59],[146,8,143,6,"console"],[146,15,143,13],[146,16,143,14,"warn"],[146,20,143,18],[146,21,143,19],[146,54,143,52],[146,55,143,53],[147,8,144,6],[148,6,145,4],[149,6,147,4],[149,12,147,10,"envelope"],[149,20,147,30],[149,23,147,33],[150,8,148,6,"type"],[150,12,148,10],[151,8,149,6,"id"],[151,10,149,8],[151,12,149,10,"Math"],[151,16,149,14],[151,17,149,15,"random"],[151,23,149,21],[151,24,149,22],[151,25,149,23],[151,26,149,24,"toString"],[151,34,149,32],[151,35,149,33],[151,37,149,35],[151,38,149,36],[151,39,149,37,"substring"],[151,48,149,46],[151,49,149,47],[151,50,149,48],[151,51,149,49],[152,8,150,6,"timestamp"],[152,17,150,15],[152,19,150,17],[152,23,150,21,"Date"],[152,27,150,25],[152,28,150,26],[152,29,150,27],[152,30,150,28,"toISOString"],[152,41,150,39],[152,42,150,40],[152,43,150,41],[153,8,151,6,"payload"],[154,6,152,4],[154,7,152,5],[155,6,154,4],[155,10,154,8],[155,11,154,9,"ws"],[155,13,154,11],[155,14,154,12,"send"],[155,18,154,16],[155,19,154,17,"JSON"],[155,23,154,21],[155,24,154,22,"stringify"],[155,33,154,31],[155,34,154,32,"envelope"],[155,42,154,40],[155,43,154,41],[155,44,154,42],[156,4,155,2],[158,4,157,2],[159,0,158,0],[160,0,159,0],[161,4,160,2,"sendExecuteRequest"],[161,22,160,20,"sendExecuteRequest"],[161,23,160,21,"draftId"],[161,30,160,36],[161,32,160,38,"touchToken"],[161,42,160,57],[161,44,160,65],[162,6,161,4],[162,10,161,8],[162,11,161,9,"send"],[162,15,161,13],[162,16,161,14],[162,33,161,31],[162,35,161,33],[163,8,162,6,"session_id"],[163,18,162,16],[163,20,162,18],[163,24,162,22],[163,25,162,23,"sessionId"],[163,34,162,32],[164,8,163,6,"draft_id"],[164,16,163,14],[164,18,163,16,"draftId"],[164,25,163,23],[165,8,164,6,"touch_token"],[165,19,164,17],[165,21,164,19,"touchToken"],[165,31,164,29],[165,35,164,33],[166,6,165,4],[166,7,165,5],[166,8,165,6],[167,4,166,2],[169,4,168,2],[170,0,169,0],[171,0,170,0],[172,4,171,2,"disconnect"],[172,14,171,12,"disconnect"],[172,15,171,12],[172,17,171,21],[173,6,172,4],[173,10,172,8],[173,11,172,9,"maxReconnectAttempts"],[173,31,172,29],[173,34,172,32],[173,35,172,33],[173,36,172,34],[173,37,172,35],[174,6,173,4],[174,10,173,8],[174,14,173,12],[174,15,173,13,"ws"],[174,17,173,15],[174,19,173,17],[175,8,174,6],[175,12,174,10],[175,13,174,11,"ws"],[175,15,174,13],[175,16,174,14,"close"],[175,21,174,19],[175,22,174,20],[175,26,174,24],[175,28,174,26],[175,47,174,45],[175,48,174,46],[176,6,175,4],[177,6,176,4],[177,10,176,8],[177,11,176,9,"_cleanup"],[177,19,176,17],[177,20,176,18],[177,21,176,19],[178,4,177,2],[180,4,179,2],[182,4,181,10,"_routeMessage"],[182,17,181,23,"_routeMessage"],[182,18,181,24,"envelope"],[182,26,181,44],[182,28,181,46,"resolve"],[182,35,181,64],[182,37,181,66,"reject"],[182,43,181,83],[182,45,181,91],[183,6,182,4],[183,12,182,10],[184,8,182,12,"type"],[185,6,182,17],[185,7,182,18],[185,10,182,21,"envelope"],[185,18,182,29],[186,6,184,4],[186,14,184,12,"type"],[186,18,184,16],[187,8,185,6],[187,13,185,11],[187,22,185,20],[188,10,186,8],[188,14,186,12],[188,15,186,13,"sessionId"],[188,24,186,22],[188,27,186,25,"envelope"],[188,35,186,33],[188,36,186,34,"payload"],[188,43,186,41],[188,44,186,42,"session_id"],[188,54,186,52],[189,10,187,8],[189,14,187,12],[189,15,187,13,"_userId"],[189,22,187,20],[189,25,187,23,"envelope"],[189,33,187,31],[189,34,187,32,"payload"],[189,41,187,39],[189,42,187,40,"user_id"],[189,49,187,47],[190,10,188,8],[190,14,188,12],[190,15,188,13,"_isAuthenticated"],[190,31,188,29],[190,34,188,32],[190,38,188,36],[191,10,189,8],[191,14,189,12],[191,15,189,13,"_startHeartbeat"],[191,30,189,28],[191,31,189,29,"envelope"],[191,39,189,37],[191,40,189,38,"payload"],[191,47,189,45],[191,48,189,46,"heartbeat_interval_ms"],[191,69,189,67],[191,73,189,71,"ENV"],[191,83,189,74],[191,84,189,74,"ENV"],[191,87,189,74],[191,88,189,75,"HEARTBEAT_INTERVAL_MS"],[191,109,189,96],[191,110,189,97],[192,10,190,8,"console"],[192,17,190,15],[192,18,190,16,"log"],[192,21,190,19],[192,22,190,20],[192,52,190,50],[192,54,190,52],[192,58,190,56],[192,59,190,57,"sessionId"],[192,68,190,66],[192,69,190,67],[193,10,191,8,"resolve"],[193,17,191,15],[193,20,191,18],[193,21,191,19],[194,10,192,8],[195,8,194,6],[195,13,194,11],[195,24,194,22],[196,10,195,8,"console"],[196,17,195,15],[196,18,195,16,"error"],[196,23,195,21],[196,24,195,22],[196,43,195,41],[196,45,195,43,"envelope"],[196,53,195,51],[196,54,195,52,"payload"],[196,61,195,59],[196,62,195,60,"reason"],[196,68,195,66],[196,69,195,67],[197,10,196,8],[197,14,196,12],[197,15,196,13,"_isAuthenticated"],[197,31,196,29],[197,34,196,32],[197,39,196,37],[198,10,197,8,"reject"],[198,16,197,14],[198,19,197,17],[198,23,197,21,"Error"],[198,28,197,26],[198,29,197,27,"envelope"],[198,37,197,35],[198,38,197,36,"payload"],[198,45,197,43],[198,46,197,44,"reason"],[198,52,197,50],[198,53,197,51],[198,54,197,52],[199,10,198,8],[200,8,200,6],[200,13,200,11],[200,28,200,26],[201,10,201,8],[202,10,202,8],[203,8,204,6],[204,10,205,8],[205,6,206,4],[207,6,208,4],[208,6,209,4],[208,10,209,8],[208,11,209,9,"_dispatch"],[208,20,209,18],[208,21,209,19,"type"],[208,25,209,23],[208,27,209,25,"envelope"],[208,35,209,33],[208,36,209,34],[209,4,210,2],[210,4,212,10,"_dispatch"],[210,13,212,19,"_dispatch"],[210,14,212,20,"type"],[210,18,212,39],[210,20,212,41,"envelope"],[210,28,212,61],[210,30,212,69],[211,6,213,4],[211,12,213,10,"handlers"],[211,20,213,18],[211,23,213,21],[211,27,213,25],[211,28,213,26,"handlers"],[211,36,213,34],[211,37,213,35,"get"],[211,40,213,38],[211,41,213,39,"type"],[211,45,213,43],[211,46,213,44],[211,50,213,48],[211,52,213,50],[212,6,214,4],[212,11,214,9],[212,17,214,15,"handler"],[212,24,214,22],[212,28,214,26,"handlers"],[212,36,214,34],[212,38,214,36],[213,8,215,6],[213,12,215,10],[214,10,216,8,"handler"],[214,17,216,15],[214,18,216,16,"envelope"],[214,26,216,24],[214,27,216,25],[215,8,217,6],[215,9,217,7],[215,10,217,8],[215,17,217,15,"err"],[215,20,217,18],[215,22,217,20],[216,10,218,8,"console"],[216,17,218,15],[216,18,218,16,"error"],[216,23,218,21],[216,24,218,22],[216,50,218,48,"type"],[216,54,218,52],[216,57,218,55],[216,59,218,57,"err"],[216,62,218,60],[216,63,218,61],[217,8,219,6],[218,6,220,4],[219,4,221,2],[220,4,223,10,"_startHeartbeat"],[220,19,223,25,"_startHeartbeat"],[220,20,223,26,"intervalMs"],[220,30,223,44],[220,32,223,52],[221,6,224,4],[221,10,224,8],[221,11,224,9,"_stopHeartbeat"],[221,25,224,23],[221,26,224,24],[221,27,224,25],[222,6,225,4],[222,10,225,8],[222,11,225,9,"heartbeatSeq"],[222,23,225,21],[222,26,225,24],[222,27,225,25],[223,6,227,4],[223,10,227,8],[223,11,227,9,"heartbeatTimer"],[223,25,227,23],[223,28,227,26,"setInterval"],[223,39,227,37],[223,40,227,38],[223,46,227,44],[224,8,228,6],[224,12,228,10],[224,16,228,14],[224,17,228,15,"ws"],[224,19,228,17],[224,23,228,21],[224,27,228,25],[224,28,228,26,"ws"],[224,30,228,28],[224,31,228,29,"readyState"],[224,41,228,39],[224,46,228,44,"WebSocket"],[224,55,228,53],[224,56,228,54,"OPEN"],[224,60,228,58],[224,64,228,62],[224,68,228,66],[224,69,228,67,"sessionId"],[224,78,228,76],[224,80,228,78],[225,10,229,8],[225,14,229,12],[225,15,229,13,"heartbeatSeq"],[225,27,229,25],[225,29,229,27],[226,10,230,8],[226,14,230,12],[226,15,230,13,"send"],[226,19,230,17],[226,20,230,18],[226,31,230,29],[226,33,230,31],[227,12,231,10,"session_id"],[227,22,231,20],[227,24,231,22],[227,28,231,26],[227,29,231,27,"sessionId"],[227,38,231,36],[228,12,232,10,"seq"],[228,15,232,13],[228,17,232,15],[228,21,232,19],[228,22,232,20,"heartbeatSeq"],[228,34,232,32],[229,12,233,10,"client_ts"],[229,21,233,19],[229,23,233,21],[229,27,233,25,"Date"],[229,31,233,29],[229,32,233,30],[229,33,233,31],[229,34,233,32,"toISOString"],[229,45,233,43],[229,46,233,44],[230,10,234,8],[230,11,234,9],[230,12,234,10],[231,8,235,6],[232,6,236,4],[232,7,236,5],[232,9,236,7,"intervalMs"],[232,19,236,17],[232,20,236,18],[233,6,238,4,"console"],[233,13,238,11],[233,14,238,12,"log"],[233,17,238,15],[233,18,238,16],[233,45,238,43,"intervalMs"],[233,55,238,53],[233,68,238,66],[233,69,238,67],[234,4,239,2],[235,4,241,10,"_stopHeartbeat"],[235,18,241,24,"_stopHeartbeat"],[235,19,241,24],[235,21,241,33],[236,6,242,4],[236,10,242,8],[236,14,242,12],[236,15,242,13,"heartbeatTimer"],[236,29,242,27],[236,31,242,29],[237,8,243,6,"clearInterval"],[237,21,243,19],[237,22,243,20],[237,26,243,24],[237,27,243,25,"heartbeatTimer"],[237,41,243,39],[237,42,243,40],[238,8,244,6],[238,12,244,10],[238,13,244,11,"heartbeatTimer"],[238,27,244,25],[238,30,244,28],[238,34,244,32],[239,6,245,4],[240,4,246,2],[241,4,248,10,"_cleanup"],[241,12,248,18,"_cleanup"],[241,13,248,18],[241,15,248,27],[242,6,249,4],[242,10,249,8],[242,11,249,9,"_stopHeartbeat"],[242,25,249,23],[242,26,249,24],[242,27,249,25],[243,6,250,4],[243,10,250,8],[243,11,250,9,"_isConnected"],[243,23,250,21],[243,26,250,24],[243,31,250,29],[244,6,251,4],[244,10,251,8],[244,11,251,9,"_isAuthenticated"],[244,27,251,25],[244,30,251,28],[244,35,251,33],[245,6,252,4],[245,10,252,8],[245,11,252,9,"sessionId"],[245,20,252,18],[245,23,252,21],[245,27,252,25],[246,6,253,4],[246,10,253,8],[246,11,253,9,"ws"],[246,13,253,11],[246,16,253,14],[246,20,253,18],[247,4,254,2],[248,2,255,0],[250,2,257,0],[251,2,258,7],[251,8,258,13,"wsClient"],[251,16,258,21],[251,19,258,24],[251,23,258,28,"MyndLensWSClient"],[251,39,258,44],[251,40,258,45],[251,41,258,46],[252,0,258,47],[252,3]],"functionMap":{"names":["<global>","MyndLensWSClient","MyndLensWSClient#get__isConnected","MyndLensWSClient#get__isAuthenticated","MyndLensWSClient#get__currentSessionId","MyndLensWSClient#get__userId","MyndLensWSClient#on","<anonymous>","MyndLensWSClient#connect","Promise$argument_0","ws.onopen","ws.onmessage","ws.onclose","setTimeout$argument_0","ws.onerror","MyndLensWSClient#send","MyndLensWSClient#sendExecuteRequest","MyndLensWSClient#disconnect","MyndLensWSClient#_routeMessage","MyndLensWSClient#_dispatch","MyndLensWSClient#_startHeartbeat","setInterval$argument_0","MyndLensWSClient#_stopHeartbeat","MyndLensWSClient#_cleanup"],"mappings":"AAA;OC8B;ECa,wDD;EEC,gEF;EGC,gEH;EIC,oDJ;EKK;WCK;KDI;GLC;EOK;uBCK;yBCc;SDW;4BEE;SFO;0BGE;uBCe,yCD;SHE;0BKE;SLG;KDK;GPC;EcK;Gdc;EeK;GfM;EgBK;GhBM;EiBI;GjB6B;EkBE;GlBS;EmBE;sCCI;KDS;GnBG;EqBE;GrBK;EsBE;GtBM;CDC"},"hasCjsExports":false},"type":"js/module"}]}