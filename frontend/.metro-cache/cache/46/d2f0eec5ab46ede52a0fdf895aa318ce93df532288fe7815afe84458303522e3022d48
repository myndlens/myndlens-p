{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"../utils/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":104},"end":{"line":5,"column":64,"index":168}}],"key":"rswhtWQFlk40P6/ZSXiz3NZSC0I=","exportNames":["*"],"imports":1}},{"name":"../config/env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":169},"end":{"line":6,"column":36,"index":205}}],"key":"RGB4LNLgNgEtjcVNHbEAgFn5Y3M=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.getOrCreateDeviceId = getOrCreateDeviceId;\n  exports.getStoredToken = getStoredToken;\n  exports.getStoredUserId = getStoredUserId;\n  exports.pairDevice = pairDevice;\n  exports.clearAuth = clearAuth;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _utilsStorage = require(_dependencyMap[1], \"../utils/storage\");\n  var _configEnv = require(_dependencyMap[2], \"../config/env\");\n  /**\n   * WebSocket auth â€” handles pairing + token management.\n   * Uses cross-platform storage wrapper.\n   */\n\n  var TOKEN_KEY = 'myndlens_auth_token';\n  var USER_ID_KEY = 'myndlens_user_id';\n  var DEVICE_ID_KEY = 'myndlens_device_id';\n  function generateDeviceId() {\n    return 'dev_' + Math.random().toString(36).substring(2, 15) + Date.now().toString(36);\n  }\n  function getOrCreateDeviceId() {\n    return _getOrCreateDeviceId.apply(this, arguments);\n  }\n  function _getOrCreateDeviceId() {\n    _getOrCreateDeviceId = (0, _asyncToGenerator.default)(function* () {\n      var deviceId = yield (0, _utilsStorage.getItem)(DEVICE_ID_KEY);\n      if (!deviceId) {\n        deviceId = generateDeviceId();\n        yield (0, _utilsStorage.setItem)(DEVICE_ID_KEY, deviceId);\n      }\n      return deviceId;\n    });\n    return _getOrCreateDeviceId.apply(this, arguments);\n  }\n  function getStoredToken() {\n    return _getStoredToken.apply(this, arguments);\n  }\n  function _getStoredToken() {\n    _getStoredToken = (0, _asyncToGenerator.default)(function* () {\n      return (0, _utilsStorage.getItem)(TOKEN_KEY);\n    });\n    return _getStoredToken.apply(this, arguments);\n  }\n  function getStoredUserId() {\n    return _getStoredUserId.apply(this, arguments);\n  }\n  function _getStoredUserId() {\n    _getStoredUserId = (0, _asyncToGenerator.default)(function* () {\n      return (0, _utilsStorage.getItem)(USER_ID_KEY);\n    });\n    return _getStoredUserId.apply(this, arguments);\n  }\n  function pairDevice(_x) {\n    return _pairDevice.apply(this, arguments);\n  }\n  function _pairDevice() {\n    _pairDevice = (0, _asyncToGenerator.default)(function* (userId) {\n      var deviceId = yield getOrCreateDeviceId();\n      var response = yield fetch(`${_configEnv.ENV.API_URL}/auth/pair`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: userId,\n          device_id: deviceId,\n          client_version: '1.0.0'\n        })\n      });\n      if (!response.ok) {\n        var text = yield response.text();\n        throw new Error(`Pairing failed: ${response.status} ${text}`);\n      }\n      var data = yield response.json();\n\n      // Store token and user ID\n      yield (0, _utilsStorage.setItem)(TOKEN_KEY, data.token);\n      yield (0, _utilsStorage.setItem)(USER_ID_KEY, data.user_id);\n      return data;\n    });\n    return _pairDevice.apply(this, arguments);\n  }\n  function clearAuth() {\n    return _clearAuth.apply(this, arguments);\n  }\n  function _clearAuth() {\n    _clearAuth = (0, _asyncToGenerator.default)(function* () {\n      yield (0, _utilsStorage.deleteItem)(TOKEN_KEY);\n      yield (0, _utilsStorage.deleteItem)(USER_ID_KEY);\n    });\n    return _clearAuth.apply(this, arguments);\n  }\n});","lineCount":104,"map":[[12,2,16,0,"exports"],[12,9,16,0],[12,10,16,0,"getOrCreateDeviceId"],[12,29,16,0],[12,32,16,0,"getOrCreateDeviceId"],[12,51,16,0],[13,2,25,0,"exports"],[13,9,25,0],[13,10,25,0,"getStoredToken"],[13,24,25,0],[13,27,25,0,"getStoredToken"],[13,41,25,0],[14,2,29,0,"exports"],[14,9,29,0],[14,10,29,0,"getStoredUserId"],[14,25,29,0],[14,28,29,0,"getStoredUserId"],[14,43,29,0],[15,2,40,0,"exports"],[15,9,40,0],[15,10,40,0,"pairDevice"],[15,20,40,0],[15,23,40,0,"pairDevice"],[15,33,40,0],[16,2,67,0,"exports"],[16,9,67,0],[16,10,67,0,"clearAuth"],[16,19,67,0],[16,22,67,0,"clearAuth"],[16,31,67,0],[17,2,70,1],[17,6,70,1,"_babelRuntimeHelpersAsyncToGenerator"],[17,42,70,1],[17,45,70,1,"require"],[17,52,70,1],[17,53,70,1,"_dependencyMap"],[17,67,70,1],[18,2,70,1],[18,6,70,1,"_asyncToGenerator"],[18,23,70,1],[18,26,70,1,"_interopDefault"],[18,41,70,1],[18,42,70,1,"_babelRuntimeHelpersAsyncToGenerator"],[18,78,70,1],[19,2,5,0],[19,6,5,0,"_utilsStorage"],[19,19,5,0],[19,22,5,0,"require"],[19,29,5,0],[19,30,5,0,"_dependencyMap"],[19,44,5,0],[20,2,6,0],[20,6,6,0,"_configEnv"],[20,16,6,0],[20,19,6,0,"require"],[20,26,6,0],[20,27,6,0,"_dependencyMap"],[20,41,6,0],[21,2,1,0],[22,0,2,0],[23,0,3,0],[24,0,4,0],[26,2,8,0],[26,6,8,6,"TOKEN_KEY"],[26,15,8,15],[26,18,8,18],[26,39,8,39],[27,2,9,0],[27,6,9,6,"USER_ID_KEY"],[27,17,9,17],[27,20,9,20],[27,38,9,38],[28,2,10,0],[28,6,10,6,"DEVICE_ID_KEY"],[28,19,10,19],[28,22,10,22],[28,42,10,42],[29,2,12,0],[29,11,12,9,"generateDeviceId"],[29,27,12,25,"generateDeviceId"],[29,28,12,25],[29,30,12,36],[30,4,13,2],[30,11,13,9],[30,17,13,15],[30,20,13,18,"Math"],[30,24,13,22],[30,25,13,23,"random"],[30,31,13,29],[30,32,13,30],[30,33,13,31],[30,34,13,32,"toString"],[30,42,13,40],[30,43,13,41],[30,45,13,43],[30,46,13,44],[30,47,13,45,"substring"],[30,56,13,54],[30,57,13,55],[30,58,13,56],[30,60,13,58],[30,62,13,60],[30,63,13,61],[30,66,13,64,"Date"],[30,70,13,68],[30,71,13,69,"now"],[30,74,13,72],[30,75,13,73],[30,76,13,74],[30,77,13,75,"toString"],[30,85,13,83],[30,86,13,84],[30,88,13,86],[30,89,13,87],[31,2,14,0],[32,2,14,1],[32,11,16,22,"getOrCreateDeviceId"],[32,30,16,41,"getOrCreateDeviceId"],[32,31,16,41],[33,4,16,41],[33,11,16,41,"_getOrCreateDeviceId"],[33,31,16,41],[33,32,16,41,"apply"],[33,37,16,41],[33,44,16,41,"arguments"],[33,53,16,41],[34,2,16,41],[35,2,16,41],[35,11,16,41,"_getOrCreateDeviceId"],[35,32,16,41],[36,4,16,41,"_getOrCreateDeviceId"],[36,24,16,41],[36,31,16,41,"_asyncToGenerator"],[36,48,16,41],[36,49,16,41,"default"],[36,56,16,41],[36,58,16,7],[36,71,16,61],[37,6,17,2],[37,10,17,6,"deviceId"],[37,18,17,14],[37,27,17,23],[37,31,17,23,"getItem"],[37,44,17,30],[37,45,17,30,"getItem"],[37,52,17,30],[37,54,17,31,"DEVICE_ID_KEY"],[37,67,17,44],[37,68,17,45],[38,6,18,2],[38,10,18,6],[38,11,18,7,"deviceId"],[38,19,18,15],[38,21,18,17],[39,8,19,4,"deviceId"],[39,16,19,12],[39,19,19,15,"generateDeviceId"],[39,35,19,31],[39,36,19,32],[39,37,19,33],[40,8,20,4],[40,14,20,10],[40,18,20,10,"setItem"],[40,31,20,17],[40,32,20,17,"setItem"],[40,39,20,17],[40,41,20,18,"DEVICE_ID_KEY"],[40,54,20,31],[40,56,20,33,"deviceId"],[40,64,20,41],[40,65,20,42],[41,6,21,2],[42,6,22,2],[42,13,22,9,"deviceId"],[42,21,22,17],[43,4,23,0],[43,5,23,1],[44,4,23,1],[44,11,23,1,"_getOrCreateDeviceId"],[44,31,23,1],[44,32,23,1,"apply"],[44,37,23,1],[44,44,23,1,"arguments"],[44,53,23,1],[45,2,23,1],[46,2,23,1],[46,11,25,22,"getStoredToken"],[46,25,25,36,"getStoredToken"],[46,26,25,36],[47,4,25,36],[47,11,25,36,"_getStoredToken"],[47,26,25,36],[47,27,25,36,"apply"],[47,32,25,36],[47,39,25,36,"arguments"],[47,48,25,36],[48,2,25,36],[49,2,25,36],[49,11,25,36,"_getStoredToken"],[49,27,25,36],[50,4,25,36,"_getStoredToken"],[50,19,25,36],[50,26,25,36,"_asyncToGenerator"],[50,43,25,36],[50,44,25,36,"default"],[50,51,25,36],[50,53,25,7],[50,66,25,63],[51,6,26,2],[51,13,26,9],[51,17,26,9,"getItem"],[51,30,26,16],[51,31,26,16,"getItem"],[51,38,26,16],[51,40,26,17,"TOKEN_KEY"],[51,49,26,26],[51,50,26,27],[52,4,27,0],[52,5,27,1],[53,4,27,1],[53,11,27,1,"_getStoredToken"],[53,26,27,1],[53,27,27,1,"apply"],[53,32,27,1],[53,39,27,1,"arguments"],[53,48,27,1],[54,2,27,1],[55,2,27,1],[55,11,29,22,"getStoredUserId"],[55,26,29,37,"getStoredUserId"],[55,27,29,37],[56,4,29,37],[56,11,29,37,"_getStoredUserId"],[56,27,29,37],[56,28,29,37,"apply"],[56,33,29,37],[56,40,29,37,"arguments"],[56,49,29,37],[57,2,29,37],[58,2,29,37],[58,11,29,37,"_getStoredUserId"],[58,28,29,37],[59,4,29,37,"_getStoredUserId"],[59,20,29,37],[59,27,29,37,"_asyncToGenerator"],[59,44,29,37],[59,45,29,37,"default"],[59,52,29,37],[59,54,29,7],[59,67,29,64],[60,6,30,2],[60,13,30,9],[60,17,30,9,"getItem"],[60,30,30,16],[60,31,30,16,"getItem"],[60,38,30,16],[60,40,30,17,"USER_ID_KEY"],[60,51,30,28],[60,52,30,29],[61,4,31,0],[61,5,31,1],[62,4,31,1],[62,11,31,1,"_getStoredUserId"],[62,27,31,1],[62,28,31,1,"apply"],[62,33,31,1],[62,40,31,1,"arguments"],[62,49,31,1],[63,2,31,1],[64,2,31,1],[64,11,40,22,"pairDevice"],[64,21,40,32,"pairDevice"],[64,22,40,32,"_x"],[64,24,40,32],[65,4,40,32],[65,11,40,32,"_pairDevice"],[65,22,40,32],[65,23,40,32,"apply"],[65,28,40,32],[65,35,40,32,"arguments"],[65,44,40,32],[66,2,40,32],[67,2,40,32],[67,11,40,32,"_pairDevice"],[67,23,40,32],[68,4,40,32,"_pairDevice"],[68,15,40,32],[68,22,40,32,"_asyncToGenerator"],[68,39,40,32],[68,40,40,32,"default"],[68,47,40,32],[68,49,40,7],[68,60,40,33,"userId"],[68,66,40,47],[68,68,40,72],[69,6,41,2],[69,10,41,8,"deviceId"],[69,18,41,16],[69,27,41,25,"getOrCreateDeviceId"],[69,46,41,44],[69,47,41,45],[69,48,41,46],[70,6,43,2],[70,10,43,8,"response"],[70,18,43,16],[70,27,43,25,"fetch"],[70,32,43,30],[70,33,43,31],[70,36,43,34,"ENV"],[70,46,43,37],[70,47,43,37,"ENV"],[70,50,43,37],[70,51,43,38,"API_URL"],[70,58,43,45],[70,70,43,57],[70,72,43,59],[71,8,44,4,"method"],[71,14,44,10],[71,16,44,12],[71,22,44,18],[72,8,45,4,"headers"],[72,15,45,11],[72,17,45,13],[73,10,45,15],[73,24,45,29],[73,26,45,31],[74,8,45,50],[74,9,45,51],[75,8,46,4,"body"],[75,12,46,8],[75,14,46,10,"JSON"],[75,18,46,14],[75,19,46,15,"stringify"],[75,28,46,24],[75,29,46,25],[76,10,47,6,"user_id"],[76,17,47,13],[76,19,47,15,"userId"],[76,25,47,21],[77,10,48,6,"device_id"],[77,19,48,15],[77,21,48,17,"deviceId"],[77,29,48,25],[78,10,49,6,"client_version"],[78,24,49,20],[78,26,49,22],[79,8,50,4],[79,9,50,5],[80,6,51,2],[80,7,51,3],[80,8,51,4],[81,6,53,2],[81,10,53,6],[81,11,53,7,"response"],[81,19,53,15],[81,20,53,16,"ok"],[81,22,53,18],[81,24,53,20],[82,8,54,4],[82,12,54,10,"text"],[82,16,54,14],[82,25,54,23,"response"],[82,33,54,31],[82,34,54,32,"text"],[82,38,54,36],[82,39,54,37],[82,40,54,38],[83,8,55,4],[83,14,55,10],[83,18,55,14,"Error"],[83,23,55,19],[83,24,55,20],[83,43,55,39,"response"],[83,51,55,47],[83,52,55,48,"status"],[83,58,55,54],[83,62,55,58,"text"],[83,66,55,62],[83,68,55,64],[83,69,55,65],[84,6,56,2],[85,6,58,2],[85,10,58,8,"data"],[85,14,58,26],[85,23,58,35,"response"],[85,31,58,43],[85,32,58,44,"json"],[85,36,58,48],[85,37,58,49],[85,38,58,50],[87,6,60,2],[88,6,61,2],[88,12,61,8],[88,16,61,8,"setItem"],[88,29,61,15],[88,30,61,15,"setItem"],[88,37,61,15],[88,39,61,16,"TOKEN_KEY"],[88,48,61,25],[88,50,61,27,"data"],[88,54,61,31],[88,55,61,32,"token"],[88,60,61,37],[88,61,61,38],[89,6,62,2],[89,12,62,8],[89,16,62,8,"setItem"],[89,29,62,15],[89,30,62,15,"setItem"],[89,37,62,15],[89,39,62,16,"USER_ID_KEY"],[89,50,62,27],[89,52,62,29,"data"],[89,56,62,33],[89,57,62,34,"user_id"],[89,64,62,41],[89,65,62,42],[90,6,64,2],[90,13,64,9,"data"],[90,17,64,13],[91,4,65,0],[91,5,65,1],[92,4,65,1],[92,11,65,1,"_pairDevice"],[92,22,65,1],[92,23,65,1,"apply"],[92,28,65,1],[92,35,65,1,"arguments"],[92,44,65,1],[93,2,65,1],[94,2,65,1],[94,11,67,22,"clearAuth"],[94,20,67,31,"clearAuth"],[94,21,67,31],[95,4,67,31],[95,11,67,31,"_clearAuth"],[95,21,67,31],[95,22,67,31,"apply"],[95,27,67,31],[95,34,67,31,"arguments"],[95,43,67,31],[96,2,67,31],[97,2,67,31],[97,11,67,31,"_clearAuth"],[97,22,67,31],[98,4,67,31,"_clearAuth"],[98,14,67,31],[98,21,67,31,"_asyncToGenerator"],[98,38,67,31],[98,39,67,31,"default"],[98,46,67,31],[98,48,67,7],[98,61,67,49],[99,6,68,2],[99,12,68,8],[99,16,68,8,"deleteItem"],[99,29,68,18],[99,30,68,18,"deleteItem"],[99,40,68,18],[99,42,68,19,"TOKEN_KEY"],[99,51,68,28],[99,52,68,29],[100,6,69,2],[100,12,69,8],[100,16,69,8,"deleteItem"],[100,29,69,18],[100,30,69,18,"deleteItem"],[100,40,69,18],[100,42,69,19,"USER_ID_KEY"],[100,53,69,30],[100,54,69,31],[101,4,70,0],[101,5,70,1],[102,4,70,1],[102,11,70,1,"_clearAuth"],[102,21,70,1],[102,22,70,1,"apply"],[102,27,70,1],[102,34,70,1,"arguments"],[102,43,70,1],[103,2,70,1],[104,0,70,1],[104,3]],"functionMap":{"names":["<global>","generateDeviceId","getOrCreateDeviceId","getStoredToken","getStoredUserId","pairDevice","clearAuth"],"mappings":"AAA;ACW;CDE;OEE;CFO;OGE;CHE;OIE;CJE;OKS;CLyB;OME;CNG"},"hasCjsExports":false},"type":"js/module"}]}