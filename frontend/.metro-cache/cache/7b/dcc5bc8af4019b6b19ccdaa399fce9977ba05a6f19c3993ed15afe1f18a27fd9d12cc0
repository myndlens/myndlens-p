{"dependencies":[{"name":"./pkg","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":16,"column":0,"index":641},"end":{"line":16,"column":50,"index":691}}],"key":"+AXKDS3Rpfle7eEXX3r5kv/MKi0=","exportNames":["*"],"imports":1}},{"name":"../utils/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":692},"end":{"line":17,"column":52,"index":744}}],"key":"rswhtWQFlk40P6/ZSXiz3NZSC0I=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.nodeToText = nodeToText;\n  exports.syncPKGToBackend = syncPKGToBackend;\n  exports.syncTombstones = syncTombstones;\n  exports.isSyncDue = isSyncDue;\n  var _pkg = require(_dependencyMap[0], \"./pkg\");\n  var _utilsStorage = require(_dependencyMap[1], \"../utils/storage\");\n  /**\n   * Digital Self Sync Manager\n   *\n   * Sends PKG node TEXT to the backend for ONNX embedding.\n   * Backend generates the 384-dim vector and stores ONLY the vector — text is discarded.\n   * On subsequent mandates, the backend resolves node_ids and the device provides\n   * the readable text on-demand (ds_resolve / ds_context WS round-trip).\n   *\n   * What travels to the backend:\n   *   SYNC:         { node_id, text }  — text used to generate vector, then discarded\n   *   PER MANDATE:  { node_id, text }  — only for 2-3 matched nodes, ephemeral\n   *   NEVER stored: raw contacts, calendar data, phone numbers\n   */\n\n  const LAST_SYNC_KEY = 'myndlens_ds_last_sync';\n  const SYNC_INTERVAL_MS = 6 * 60 * 60 * 1000; // 6 hours\n\n  // ── Node text builder ──────────────────────────────────────────────────────\n\n  /**\n   * Convert a PKG node to a meaningful text string for ONNX embedding.\n   * The text encodes the node's identity and relationships so that\n   * the backend can semantically match it against a user's spoken transcript.\n   */\n  function nodeToText(node) {\n    const parts = [node.label];\n    switch (node.type) {\n      case 'Person':\n        {\n          if (node.data.relationship) parts.push(node.data.relationship);\n          if (node.data.organization) parts.push(node.data.organization);\n          if (node.data.signal) parts.push(node.data.signal);\n          break;\n        }\n      case 'Place':\n        {\n          if (node.data.category) parts.push(node.data.category);\n          if (node.data.address) parts.push(node.data.address);\n          break;\n        }\n      case 'Trait':\n      case 'Interest':\n        {\n          if (node.data.context) parts.push(node.data.context);\n          break;\n        }\n      case 'Event':\n        {\n          if (node.data.date) parts.push(node.data.date);\n          if (node.data.location) parts.push(node.data.location);\n          if (node.data.attendees) parts.push(`with ${node.data.attendees}`);\n          break;\n        }\n      case 'Task':\n      case 'Project':\n      case 'Document':\n        {\n          if (node.data.description) parts.push(node.data.description);\n          if (node.data.status) parts.push(node.data.status);\n          break;\n        }\n      default:\n        {\n          if (node.data.value) parts.push(String(node.data.value));\n          if (node.data.context) parts.push(String(node.data.context));\n          break;\n        }\n    }\n    return parts.filter(Boolean).join(' — ');\n  }\n\n  // ── Delta detection ────────────────────────────────────────────────────────\n\n  /**\n   * Returns nodes that need syncing: updated_at > synced_at (or never synced).\n   */\n  function getDelta(nodes) {\n    return nodes.filter(n => {\n      if (!n.synced_at) return true;\n      return new Date(n.updated_at) > new Date(n.synced_at);\n    });\n  }\n\n  // ── Sync to backend ────────────────────────────────────────────────────────\n\n  /**\n   * Sync delta PKG nodes to the backend.\n   *\n   * Sends { node_id, text } pairs over HTTPS (TLS encrypted).\n   * Backend embeds the text using ONNX (bge-small-en-v1.5) and stores\n   * ONLY the resulting vector — the text is never persisted on the backend.\n   *\n   * @param userId  - the authenticated user id\n   * @param force   - if true, sync all nodes regardless of synced_at\n   */\n  async function syncPKGToBackend(userId, force = false) {\n    const result = {\n      synced: 0,\n      deleted: 0,\n      skipped: 0\n    };\n    try {\n      const pkg = await (0, _pkg.loadPKG)(userId);\n      const allNodes = Object.values(pkg.nodes);\n      const delta = force ? allNodes : getDelta(allNodes);\n      if (delta.length === 0) {\n        result.skipped = allNodes.length;\n        return result;\n      }\n      const apiUrl = process.env.EXPO_PUBLIC_BACKEND_URL ?? '';\n      const token = (await (0, _utilsStorage.getItem)('myndlens_auth_token')) ?? '';\n\n      // Build payload — { node_id, text } only. No raw personal data beyond the label.\n      const payload = {\n        user_id: userId,\n        nodes: delta.map(n => ({\n          node_id: n.id,\n          text: nodeToText(n)\n        }))\n      };\n      const response = await fetch(`${apiUrl}/api/digital-self/sync`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify(payload)\n      });\n      if (!response.ok) {\n        const err = await response.text();\n        result.error = `HTTP ${response.status}: ${err}`;\n        return result;\n      }\n\n      // Mark synced nodes with current timestamp\n      const now = new Date().toISOString();\n      for (const node of delta) {\n        if (pkg.nodes[node.id]) {\n          pkg.nodes[node.id].synced_at = now;\n        }\n      }\n      await (0, _pkg.savePKG)(pkg);\n      await (0, _utilsStorage.setItem)(LAST_SYNC_KEY, now);\n      result.synced = delta.length;\n      result.skipped = allNodes.length - delta.length;\n      return result;\n    } catch (err) {\n      result.error = err?.message ?? 'Unknown sync error';\n      return result;\n    }\n  }\n\n  /**\n   * Notify backend to remove vectors for deleted PKG nodes.\n   */\n  async function syncTombstones(userId, deletedNodeIds) {\n    if (deletedNodeIds.length === 0) return;\n    try {\n      const apiUrl = process.env.EXPO_PUBLIC_BACKEND_URL ?? '';\n      const token = (await (0, _utilsStorage.getItem)('myndlens_auth_token')) ?? '';\n      await fetch(`${apiUrl}/api/digital-self/sync`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          user_id: userId,\n          deleted_node_ids: deletedNodeIds\n        })\n      });\n    } catch {\n      // Tombstone sync failure is non-fatal — stale vectors cause no harm, just noise\n    }\n  }\n\n  /**\n   * Returns true if a foreground sync is due (last sync > SYNC_INTERVAL_MS ago).\n   */\n  async function isSyncDue() {\n    const last = await (0, _utilsStorage.getItem)(LAST_SYNC_KEY);\n    if (!last) return true;\n    return Date.now() - new Date(last).getTime() > SYNC_INTERVAL_MS;\n  }\n});","lineCount":197,"map":[[7,2,29,0,"exports"],[7,9,29,0],[7,10,29,0,"nodeToText"],[7,20,29,0],[7,23,29,0,"nodeToText"],[7,33,29,0],[8,2,105,0,"exports"],[8,9,105,0],[8,10,105,0,"syncPKGToBackend"],[8,26,105,0],[8,29,105,0,"syncPKGToBackend"],[8,45,105,0],[9,2,168,0,"exports"],[9,9,168,0],[9,10,168,0,"syncTombstones"],[9,24,168,0],[9,27,168,0,"syncTombstones"],[9,41,168,0],[10,2,194,0,"exports"],[10,9,194,0],[10,10,194,0,"isSyncDue"],[10,19,194,0],[10,22,194,0,"isSyncDue"],[10,31,194,0],[11,2,16,0],[11,6,16,0,"_pkg"],[11,10,16,0],[11,13,16,0,"require"],[11,20,16,0],[11,21,16,0,"_dependencyMap"],[11,35,16,0],[12,2,17,0],[12,6,17,0,"_utilsStorage"],[12,19,17,0],[12,22,17,0,"require"],[12,29,17,0],[12,30,17,0,"_dependencyMap"],[12,44,17,0],[13,2,1,0],[14,0,2,0],[15,0,3,0],[16,0,4,0],[17,0,5,0],[18,0,6,0],[19,0,7,0],[20,0,8,0],[21,0,9,0],[22,0,10,0],[23,0,11,0],[24,0,12,0],[25,0,13,0],[27,2,19,0],[27,8,19,6,"LAST_SYNC_KEY"],[27,21,19,19],[27,24,19,22],[27,47,19,45],[28,2,20,0],[28,8,20,6,"SYNC_INTERVAL_MS"],[28,24,20,22],[28,27,20,25],[28,28,20,26],[28,31,20,29],[28,33,20,31],[28,36,20,34],[28,38,20,36],[28,41,20,39],[28,45,20,43],[28,46,20,44],[28,47,20,45],[30,2,22,0],[32,2,24,0],[33,0,25,0],[34,0,26,0],[35,0,27,0],[36,0,28,0],[37,2,29,7],[37,11,29,16,"nodeToText"],[37,21,29,26,"nodeToText"],[37,22,29,27,"node"],[37,26,29,40],[37,28,29,50],[38,4,30,2],[38,10,30,8,"parts"],[38,15,30,23],[38,18,30,26],[38,19,30,27,"node"],[38,23,30,31],[38,24,30,32,"label"],[38,29,30,37],[38,30,30,38],[39,4,32,2],[39,12,32,10,"node"],[39,16,32,14],[39,17,32,15,"type"],[39,21,32,19],[40,6,33,4],[40,11,33,9],[40,19,33,17],[41,8,33,19],[42,10,34,6],[42,14,34,10,"node"],[42,18,34,14],[42,19,34,15,"data"],[42,23,34,19],[42,24,34,20,"relationship"],[42,36,34,32],[42,38,34,34,"parts"],[42,43,34,39],[42,44,34,40,"push"],[42,48,34,44],[42,49,34,45,"node"],[42,53,34,49],[42,54,34,50,"data"],[42,58,34,54],[42,59,34,55,"relationship"],[42,71,34,67],[42,72,34,68],[43,10,35,6],[43,14,35,10,"node"],[43,18,35,14],[43,19,35,15,"data"],[43,23,35,19],[43,24,35,20,"organization"],[43,36,35,32],[43,38,35,34,"parts"],[43,43,35,39],[43,44,35,40,"push"],[43,48,35,44],[43,49,35,45,"node"],[43,53,35,49],[43,54,35,50,"data"],[43,58,35,54],[43,59,35,55,"organization"],[43,71,35,67],[43,72,35,68],[44,10,36,6],[44,14,36,10,"node"],[44,18,36,14],[44,19,36,15,"data"],[44,23,36,19],[44,24,36,20,"signal"],[44,30,36,26],[44,32,36,28,"parts"],[44,37,36,33],[44,38,36,34,"push"],[44,42,36,38],[44,43,36,39,"node"],[44,47,36,43],[44,48,36,44,"data"],[44,52,36,48],[44,53,36,49,"signal"],[44,59,36,55],[44,60,36,56],[45,10,37,6],[46,8,38,4],[47,6,39,4],[47,11,39,9],[47,18,39,16],[48,8,39,18],[49,10,40,6],[49,14,40,10,"node"],[49,18,40,14],[49,19,40,15,"data"],[49,23,40,19],[49,24,40,20,"category"],[49,32,40,28],[49,34,40,30,"parts"],[49,39,40,35],[49,40,40,36,"push"],[49,44,40,40],[49,45,40,41,"node"],[49,49,40,45],[49,50,40,46,"data"],[49,54,40,50],[49,55,40,51,"category"],[49,63,40,59],[49,64,40,60],[50,10,41,6],[50,14,41,10,"node"],[50,18,41,14],[50,19,41,15,"data"],[50,23,41,19],[50,24,41,20,"address"],[50,31,41,27],[50,33,41,29,"parts"],[50,38,41,34],[50,39,41,35,"push"],[50,43,41,39],[50,44,41,40,"node"],[50,48,41,44],[50,49,41,45,"data"],[50,53,41,49],[50,54,41,50,"address"],[50,61,41,57],[50,62,41,58],[51,10,42,6],[52,8,43,4],[53,6,44,4],[53,11,44,9],[53,18,44,16],[54,6,45,4],[54,11,45,9],[54,21,45,19],[55,8,45,21],[56,10,46,6],[56,14,46,10,"node"],[56,18,46,14],[56,19,46,15,"data"],[56,23,46,19],[56,24,46,20,"context"],[56,31,46,27],[56,33,46,29,"parts"],[56,38,46,34],[56,39,46,35,"push"],[56,43,46,39],[56,44,46,40,"node"],[56,48,46,44],[56,49,46,45,"data"],[56,53,46,49],[56,54,46,50,"context"],[56,61,46,57],[56,62,46,58],[57,10,47,6],[58,8,48,4],[59,6,49,4],[59,11,49,9],[59,18,49,16],[60,8,49,18],[61,10,50,6],[61,14,50,10,"node"],[61,18,50,14],[61,19,50,15,"data"],[61,23,50,19],[61,24,50,20,"date"],[61,28,50,24],[61,30,50,26,"parts"],[61,35,50,31],[61,36,50,32,"push"],[61,40,50,36],[61,41,50,37,"node"],[61,45,50,41],[61,46,50,42,"data"],[61,50,50,46],[61,51,50,47,"date"],[61,55,50,51],[61,56,50,52],[62,10,51,6],[62,14,51,10,"node"],[62,18,51,14],[62,19,51,15,"data"],[62,23,51,19],[62,24,51,20,"location"],[62,32,51,28],[62,34,51,30,"parts"],[62,39,51,35],[62,40,51,36,"push"],[62,44,51,40],[62,45,51,41,"node"],[62,49,51,45],[62,50,51,46,"data"],[62,54,51,50],[62,55,51,51,"location"],[62,63,51,59],[62,64,51,60],[63,10,52,6],[63,14,52,10,"node"],[63,18,52,14],[63,19,52,15,"data"],[63,23,52,19],[63,24,52,20,"attendees"],[63,33,52,29],[63,35,52,31,"parts"],[63,40,52,36],[63,41,52,37,"push"],[63,45,52,41],[63,46,52,42],[63,54,52,50,"node"],[63,58,52,54],[63,59,52,55,"data"],[63,63,52,59],[63,64,52,60,"attendees"],[63,73,52,69],[63,75,52,71],[63,76,52,72],[64,10,53,6],[65,8,54,4],[66,6,55,4],[66,11,55,9],[66,17,55,15],[67,6,56,4],[67,11,56,9],[67,20,56,18],[68,6,57,4],[68,11,57,9],[68,21,57,19],[69,8,57,21],[70,10,58,6],[70,14,58,10,"node"],[70,18,58,14],[70,19,58,15,"data"],[70,23,58,19],[70,24,58,20,"description"],[70,35,58,31],[70,37,58,33,"parts"],[70,42,58,38],[70,43,58,39,"push"],[70,47,58,43],[70,48,58,44,"node"],[70,52,58,48],[70,53,58,49,"data"],[70,57,58,53],[70,58,58,54,"description"],[70,69,58,65],[70,70,58,66],[71,10,59,6],[71,14,59,10,"node"],[71,18,59,14],[71,19,59,15,"data"],[71,23,59,19],[71,24,59,20,"status"],[71,30,59,26],[71,32,59,28,"parts"],[71,37,59,33],[71,38,59,34,"push"],[71,42,59,38],[71,43,59,39,"node"],[71,47,59,43],[71,48,59,44,"data"],[71,52,59,48],[71,53,59,49,"status"],[71,59,59,55],[71,60,59,56],[72,10,60,6],[73,8,61,4],[74,6,62,4],[75,8,62,13],[76,10,63,6],[76,14,63,10,"node"],[76,18,63,14],[76,19,63,15,"data"],[76,23,63,19],[76,24,63,20,"value"],[76,29,63,25],[76,31,63,27,"parts"],[76,36,63,32],[76,37,63,33,"push"],[76,41,63,37],[76,42,63,38,"String"],[76,48,63,44],[76,49,63,45,"node"],[76,53,63,49],[76,54,63,50,"data"],[76,58,63,54],[76,59,63,55,"value"],[76,64,63,60],[76,65,63,61],[76,66,63,62],[77,10,64,6],[77,14,64,10,"node"],[77,18,64,14],[77,19,64,15,"data"],[77,23,64,19],[77,24,64,20,"context"],[77,31,64,27],[77,33,64,29,"parts"],[77,38,64,34],[77,39,64,35,"push"],[77,43,64,39],[77,44,64,40,"String"],[77,50,64,46],[77,51,64,47,"node"],[77,55,64,51],[77,56,64,52,"data"],[77,60,64,56],[77,61,64,57,"context"],[77,68,64,64],[77,69,64,65],[77,70,64,66],[78,10,65,6],[79,8,66,4],[80,4,67,2],[81,4,69,2],[81,11,69,9,"parts"],[81,16,69,14],[81,17,69,15,"filter"],[81,23,69,21],[81,24,69,22,"Boolean"],[81,31,69,29],[81,32,69,30],[81,33,69,31,"join"],[81,37,69,35],[81,38,69,36],[81,43,69,41],[81,44,69,42],[82,2,70,0],[84,2,73,0],[86,2,75,0],[87,0,76,0],[88,0,77,0],[89,2,78,0],[89,11,78,9,"getDelta"],[89,19,78,17,"getDelta"],[89,20,78,18,"nodes"],[89,25,78,34],[89,27,78,47],[90,4,79,2],[90,11,79,9,"nodes"],[90,16,79,14],[90,17,79,15,"filter"],[90,23,79,21],[90,24,79,22,"n"],[90,25,79,23],[90,29,79,27],[91,6,80,4],[91,10,80,8],[91,11,80,9,"n"],[91,12,80,10],[91,13,80,11,"synced_at"],[91,22,80,20],[91,24,80,22],[91,31,80,29],[91,35,80,33],[92,6,81,4],[92,13,81,11],[92,17,81,15,"Date"],[92,21,81,19],[92,22,81,20,"n"],[92,23,81,21],[92,24,81,22,"updated_at"],[92,34,81,32],[92,35,81,33],[92,38,81,36],[92,42,81,40,"Date"],[92,46,81,44],[92,47,81,45,"n"],[92,48,81,46],[92,49,81,47,"synced_at"],[92,58,81,56],[92,59,81,57],[93,4,82,2],[93,5,82,3],[93,6,82,4],[94,2,83,0],[96,2,86,0],[98,2,95,0],[99,0,96,0],[100,0,97,0],[101,0,98,0],[102,0,99,0],[103,0,100,0],[104,0,101,0],[105,0,102,0],[106,0,103,0],[107,0,104,0],[108,2,105,7],[108,17,105,22,"syncPKGToBackend"],[108,33,105,38,"syncPKGToBackend"],[108,34,106,2,"userId"],[108,40,106,16],[108,42,107,2,"force"],[108,47,107,7],[108,50,107,10],[108,55,107,15],[108,57,108,23],[109,4,109,2],[109,10,109,8,"result"],[109,16,109,26],[109,19,109,29],[110,6,109,31,"synced"],[110,12,109,37],[110,14,109,39],[110,15,109,40],[111,6,109,42,"deleted"],[111,13,109,49],[111,15,109,51],[111,16,109,52],[112,6,109,54,"skipped"],[112,13,109,61],[112,15,109,63],[113,4,109,65],[113,5,109,66],[114,4,111,2],[114,8,111,6],[115,6,112,4],[115,12,112,10,"pkg"],[115,15,112,13],[115,18,112,16],[115,24,112,22],[115,28,112,22,"loadPKG"],[115,32,112,29],[115,33,112,29,"loadPKG"],[115,40,112,29],[115,42,112,30,"userId"],[115,48,112,36],[115,49,112,37],[116,6,113,4],[116,12,113,10,"allNodes"],[116,20,113,18],[116,23,113,21,"Object"],[116,29,113,27],[116,30,113,28,"values"],[116,36,113,34],[116,37,113,35,"pkg"],[116,40,113,38],[116,41,113,39,"nodes"],[116,46,113,44],[116,47,113,45],[117,6,114,4],[117,12,114,10,"delta"],[117,17,114,15],[117,20,114,18,"force"],[117,25,114,23],[117,28,114,26,"allNodes"],[117,36,114,34],[117,39,114,37,"getDelta"],[117,47,114,45],[117,48,114,46,"allNodes"],[117,56,114,54],[117,57,114,55],[118,6,116,4],[118,10,116,8,"delta"],[118,15,116,13],[118,16,116,14,"length"],[118,22,116,20],[118,27,116,25],[118,28,116,26],[118,30,116,28],[119,8,117,6,"result"],[119,14,117,12],[119,15,117,13,"skipped"],[119,22,117,20],[119,25,117,23,"allNodes"],[119,33,117,31],[119,34,117,32,"length"],[119,40,117,38],[120,8,118,6],[120,15,118,13,"result"],[120,21,118,19],[121,6,119,4],[122,6,121,4],[122,12,121,10,"apiUrl"],[122,18,121,16],[122,21,121,19,"process"],[122,28,121,26],[122,29,121,27,"env"],[122,32,121,30],[122,33,121,31,"EXPO_PUBLIC_BACKEND_URL"],[122,56,121,54],[122,60,121,58],[122,62,121,60],[123,6,122,4],[123,12,122,10,"token"],[123,17,122,15],[123,20,122,18],[123,27,122,24],[123,31,122,24,"getItem"],[123,44,122,31],[123,45,122,31,"getItem"],[123,52,122,31],[123,54,122,32],[123,75,122,53],[123,76,122,54],[123,81,122,58],[123,83,122,60],[125,6,124,4],[126,6,125,4],[126,12,125,10,"payload"],[126,19,125,17],[126,22,125,20],[127,8,126,6,"user_id"],[127,15,126,13],[127,17,126,15,"userId"],[127,23,126,21],[128,8,127,6,"nodes"],[128,13,127,11],[128,15,127,13,"delta"],[128,20,127,18],[128,21,127,19,"map"],[128,24,127,22],[128,25,127,23,"n"],[128,26,127,24],[128,31,127,29],[129,10,127,31,"node_id"],[129,17,127,38],[129,19,127,40,"n"],[129,20,127,41],[129,21,127,42,"id"],[129,23,127,44],[130,10,127,46,"text"],[130,14,127,50],[130,16,127,52,"nodeToText"],[130,26,127,62],[130,27,127,63,"n"],[130,28,127,64],[131,8,127,66],[131,9,127,67],[131,10,127,68],[132,6,128,4],[132,7,128,5],[133,6,130,4],[133,12,130,10,"response"],[133,20,130,18],[133,23,130,21],[133,29,130,27,"fetch"],[133,34,130,32],[133,35,130,33],[133,38,130,36,"apiUrl"],[133,44,130,42],[133,68,130,66],[133,70,130,68],[134,8,131,6,"method"],[134,14,131,12],[134,16,131,14],[134,22,131,20],[135,8,132,6,"headers"],[135,15,132,13],[135,17,132,15],[136,10,133,8],[136,24,133,22],[136,26,133,24],[136,44,133,42],[137,10,134,8,"Authorization"],[137,23,134,21],[137,25,134,23],[137,35,134,33,"token"],[137,40,134,38],[138,8,135,6],[138,9,135,7],[139,8,136,6,"body"],[139,12,136,10],[139,14,136,12,"JSON"],[139,18,136,16],[139,19,136,17,"stringify"],[139,28,136,26],[139,29,136,27,"payload"],[139,36,136,34],[140,6,137,4],[140,7,137,5],[140,8,137,6],[141,6,139,4],[141,10,139,8],[141,11,139,9,"response"],[141,19,139,17],[141,20,139,18,"ok"],[141,22,139,20],[141,24,139,22],[142,8,140,6],[142,14,140,12,"err"],[142,17,140,15],[142,20,140,18],[142,26,140,24,"response"],[142,34,140,32],[142,35,140,33,"text"],[142,39,140,37],[142,40,140,38],[142,41,140,39],[143,8,141,6,"result"],[143,14,141,12],[143,15,141,13,"error"],[143,20,141,18],[143,23,141,21],[143,31,141,29,"response"],[143,39,141,37],[143,40,141,38,"status"],[143,46,141,44],[143,51,141,49,"err"],[143,54,141,52],[143,56,141,54],[144,8,142,6],[144,15,142,13,"result"],[144,21,142,19],[145,6,143,4],[147,6,145,4],[148,6,146,4],[148,12,146,10,"now"],[148,15,146,13],[148,18,146,16],[148,22,146,20,"Date"],[148,26,146,24],[148,27,146,25],[148,28,146,26],[148,29,146,27,"toISOString"],[148,40,146,38],[148,41,146,39],[148,42,146,40],[149,6,147,4],[149,11,147,9],[149,17,147,15,"node"],[149,21,147,19],[149,25,147,23,"delta"],[149,30,147,28],[149,32,147,30],[150,8,148,6],[150,12,148,10,"pkg"],[150,15,148,13],[150,16,148,14,"nodes"],[150,21,148,19],[150,22,148,20,"node"],[150,26,148,24],[150,27,148,25,"id"],[150,29,148,27],[150,30,148,28],[150,32,148,30],[151,10,149,8,"pkg"],[151,13,149,11],[151,14,149,12,"nodes"],[151,19,149,17],[151,20,149,18,"node"],[151,24,149,22],[151,25,149,23,"id"],[151,27,149,25],[151,28,149,26],[151,29,149,27,"synced_at"],[151,38,149,36],[151,41,149,39,"now"],[151,44,149,42],[152,8,150,6],[153,6,151,4],[154,6,152,4],[154,12,152,10],[154,16,152,10,"savePKG"],[154,20,152,17],[154,21,152,17,"savePKG"],[154,28,152,17],[154,30,152,18,"pkg"],[154,33,152,21],[154,34,152,22],[155,6,153,4],[155,12,153,10],[155,16,153,10,"setItem"],[155,29,153,17],[155,30,153,17,"setItem"],[155,37,153,17],[155,39,153,18,"LAST_SYNC_KEY"],[155,52,153,31],[155,54,153,33,"now"],[155,57,153,36],[155,58,153,37],[156,6,155,4,"result"],[156,12,155,10],[156,13,155,11,"synced"],[156,19,155,17],[156,22,155,20,"delta"],[156,27,155,25],[156,28,155,26,"length"],[156,34,155,32],[157,6,156,4,"result"],[157,12,156,10],[157,13,156,11,"skipped"],[157,20,156,18],[157,23,156,21,"allNodes"],[157,31,156,29],[157,32,156,30,"length"],[157,38,156,36],[157,41,156,39,"delta"],[157,46,156,44],[157,47,156,45,"length"],[157,53,156,51],[158,6,157,4],[158,13,157,11,"result"],[158,19,157,17],[159,4,158,2],[159,5,158,3],[159,6,158,4],[159,13,158,11,"err"],[159,16,158,19],[159,18,158,21],[160,6,159,4,"result"],[160,12,159,10],[160,13,159,11,"error"],[160,18,159,16],[160,21,159,19,"err"],[160,24,159,22],[160,26,159,24,"message"],[160,33,159,31],[160,37,159,35],[160,57,159,55],[161,6,160,4],[161,13,160,11,"result"],[161,19,160,17],[162,4,161,2],[163,2,162,0],[165,2,165,0],[166,0,166,0],[167,0,167,0],[168,2,168,7],[168,17,168,22,"syncTombstones"],[168,31,168,36,"syncTombstones"],[168,32,169,2,"userId"],[168,38,169,16],[168,40,170,2,"deletedNodeIds"],[168,54,170,26],[168,56,171,17],[169,4,172,2],[169,8,172,6,"deletedNodeIds"],[169,22,172,20],[169,23,172,21,"length"],[169,29,172,27],[169,34,172,32],[169,35,172,33],[169,37,172,35],[170,4,173,2],[170,8,173,6],[171,6,174,4],[171,12,174,10,"apiUrl"],[171,18,174,16],[171,21,174,19,"process"],[171,28,174,26],[171,29,174,27,"env"],[171,32,174,30],[171,33,174,31,"EXPO_PUBLIC_BACKEND_URL"],[171,56,174,54],[171,60,174,58],[171,62,174,60],[172,6,175,4],[172,12,175,10,"token"],[172,17,175,15],[172,20,175,18],[172,27,175,24],[172,31,175,24,"getItem"],[172,44,175,31],[172,45,175,31,"getItem"],[172,52,175,31],[172,54,175,32],[172,75,175,53],[172,76,175,54],[172,81,175,58],[172,83,175,60],[173,6,177,4],[173,12,177,10,"fetch"],[173,17,177,15],[173,18,177,16],[173,21,177,19,"apiUrl"],[173,27,177,25],[173,51,177,49],[173,53,177,51],[174,8,178,6,"method"],[174,14,178,12],[174,16,178,14],[174,24,178,22],[175,8,179,6,"headers"],[175,15,179,13],[175,17,179,15],[176,10,180,8],[176,24,180,22],[176,26,180,24],[176,44,180,42],[177,10,181,8,"Authorization"],[177,23,181,21],[177,25,181,23],[177,35,181,33,"token"],[177,40,181,38],[178,8,182,6],[178,9,182,7],[179,8,183,6,"body"],[179,12,183,10],[179,14,183,12,"JSON"],[179,18,183,16],[179,19,183,17,"stringify"],[179,28,183,26],[179,29,183,27],[180,10,183,29,"user_id"],[180,17,183,36],[180,19,183,38,"userId"],[180,25,183,44],[181,10,183,46,"deleted_node_ids"],[181,26,183,62],[181,28,183,64,"deletedNodeIds"],[182,8,183,79],[182,9,183,80],[183,6,184,4],[183,7,184,5],[183,8,184,6],[184,4,185,2],[184,5,185,3],[184,6,185,4],[184,12,185,10],[185,6,186,4],[186,4,186,4],[187,2,188,0],[189,2,191,0],[190,0,192,0],[191,0,193,0],[192,2,194,7],[192,17,194,22,"isSyncDue"],[192,26,194,31,"isSyncDue"],[192,27,194,31],[192,29,194,52],[193,4,195,2],[193,10,195,8,"last"],[193,14,195,12],[193,17,195,15],[193,23,195,21],[193,27,195,21,"getItem"],[193,40,195,28],[193,41,195,28,"getItem"],[193,48,195,28],[193,50,195,29,"LAST_SYNC_KEY"],[193,63,195,42],[193,64,195,43],[194,4,196,2],[194,8,196,6],[194,9,196,7,"last"],[194,13,196,11],[194,15,196,13],[194,22,196,20],[194,26,196,24],[195,4,197,2],[195,11,197,9,"Date"],[195,15,197,13],[195,16,197,14,"now"],[195,19,197,17],[195,20,197,18],[195,21,197,19],[195,24,197,22],[195,28,197,26,"Date"],[195,32,197,30],[195,33,197,31,"last"],[195,37,197,35],[195,38,197,36],[195,39,197,37,"getTime"],[195,46,197,44],[195,47,197,45],[195,48,197,46],[195,51,197,49,"SYNC_INTERVAL_MS"],[195,67,197,65],[196,2,198,0],[197,0,198,1],[197,3]],"functionMap":{"names":["<global>","nodeToText","getDelta","nodes.filter$argument_0","syncPKGToBackend","delta.map$argument_0","syncTombstones","isSyncDue"],"mappings":"AAA;OC4B;CDyC;AEQ;sBCC;GDG;CFC;OIsB;uBCsB,6CD;CJmC;OMM;CNoB;OOM;CPI"},"hasCjsExports":false},"type":"js/module"}]}