{"dependencies":[{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":64},"end":{"line":4,"column":49,"index":113}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"../config/env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":114},"end":{"line":5,"column":36,"index":150}}],"key":"RGB4LNLgNgEtjcVNHbEAgFn5Y3M=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.getOrCreateDeviceId = getOrCreateDeviceId;\n  exports.getStoredToken = getStoredToken;\n  exports.getStoredUserId = getStoredUserId;\n  exports.pairDevice = pairDevice;\n  exports.clearAuth = clearAuth;\n  var _expoSecureStore = require(_dependencyMap[0], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var _configEnv = require(_dependencyMap[1], \"../config/env\");\n  /**\n   * WebSocket auth â€” handles pairing + token management.\n   */\n\n  const TOKEN_KEY = 'myndlens_auth_token';\n  const USER_ID_KEY = 'myndlens_user_id';\n  const DEVICE_ID_KEY = 'myndlens_device_id';\n  function generateDeviceId() {\n    // Simple random ID for now; in production use expo-device or a crypto UUID\n    return 'dev_' + Math.random().toString(36).substring(2, 15) + Date.now().toString(36);\n  }\n  async function getOrCreateDeviceId() {\n    let deviceId = await SecureStore.getItemAsync(DEVICE_ID_KEY);\n    if (!deviceId) {\n      deviceId = generateDeviceId();\n      await SecureStore.setItemAsync(DEVICE_ID_KEY, deviceId);\n    }\n    return deviceId;\n  }\n  async function getStoredToken() {\n    return SecureStore.getItemAsync(TOKEN_KEY);\n  }\n  async function getStoredUserId() {\n    return SecureStore.getItemAsync(USER_ID_KEY);\n  }\n  async function pairDevice(userId) {\n    const deviceId = await getOrCreateDeviceId();\n    const response = await fetch(`${_configEnv.ENV.API_URL}/auth/pair`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        user_id: userId,\n        device_id: deviceId,\n        client_version: '1.0.0'\n      })\n    });\n    if (!response.ok) {\n      const text = await response.text();\n      throw new Error(`Pairing failed: ${response.status} ${text}`);\n    }\n    const data = await response.json();\n\n    // Store token and user ID securely\n    await SecureStore.setItemAsync(TOKEN_KEY, data.token);\n    await SecureStore.setItemAsync(USER_ID_KEY, data.user_id);\n    return data;\n  }\n  async function clearAuth() {\n    await SecureStore.deleteItemAsync(TOKEN_KEY);\n    await SecureStore.deleteItemAsync(USER_ID_KEY);\n  }\n});","lineCount":83,"map":[[22,2,16,0,"exports"],[22,9,16,0],[22,10,16,0,"getOrCreateDeviceId"],[22,29,16,0],[22,32,16,0,"getOrCreateDeviceId"],[22,51,16,0],[23,2,25,0,"exports"],[23,9,25,0],[23,10,25,0,"getStoredToken"],[23,24,25,0],[23,27,25,0,"getStoredToken"],[23,41,25,0],[24,2,29,0,"exports"],[24,9,29,0],[24,10,29,0,"getStoredUserId"],[24,25,29,0],[24,28,29,0,"getStoredUserId"],[24,43,29,0],[25,2,40,0,"exports"],[25,9,40,0],[25,10,40,0,"pairDevice"],[25,20,40,0],[25,23,40,0,"pairDevice"],[25,33,40,0],[26,2,67,0,"exports"],[26,9,67,0],[26,10,67,0,"clearAuth"],[26,19,67,0],[26,22,67,0,"clearAuth"],[26,31,67,0],[27,2,4,0],[27,6,4,0,"_expoSecureStore"],[27,22,4,0],[27,25,4,0,"require"],[27,32,4,0],[27,33,4,0,"_dependencyMap"],[27,47,4,0],[28,2,4,0],[28,6,4,0,"SecureStore"],[28,17,4,0],[28,20,4,0,"_interopNamespace"],[28,37,4,0],[28,38,4,0,"_expoSecureStore"],[28,54,4,0],[29,2,5,0],[29,6,5,0,"_configEnv"],[29,16,5,0],[29,19,5,0,"require"],[29,26,5,0],[29,27,5,0,"_dependencyMap"],[29,41,5,0],[30,2,1,0],[31,0,2,0],[32,0,3,0],[34,2,7,0],[34,8,7,6,"TOKEN_KEY"],[34,17,7,15],[34,20,7,18],[34,41,7,39],[35,2,8,0],[35,8,8,6,"USER_ID_KEY"],[35,19,8,17],[35,22,8,20],[35,40,8,38],[36,2,9,0],[36,8,9,6,"DEVICE_ID_KEY"],[36,21,9,19],[36,24,9,22],[36,44,9,42],[37,2,11,0],[37,11,11,9,"generateDeviceId"],[37,27,11,25,"generateDeviceId"],[37,28,11,25],[37,30,11,36],[38,4,12,2],[39,4,13,2],[39,11,13,9],[39,17,13,15],[39,20,13,18,"Math"],[39,24,13,22],[39,25,13,23,"random"],[39,31,13,29],[39,32,13,30],[39,33,13,31],[39,34,13,32,"toString"],[39,42,13,40],[39,43,13,41],[39,45,13,43],[39,46,13,44],[39,47,13,45,"substring"],[39,56,13,54],[39,57,13,55],[39,58,13,56],[39,60,13,58],[39,62,13,60],[39,63,13,61],[39,66,13,64,"Date"],[39,70,13,68],[39,71,13,69,"now"],[39,74,13,72],[39,75,13,73],[39,76,13,74],[39,77,13,75,"toString"],[39,85,13,83],[39,86,13,84],[39,88,13,86],[39,89,13,87],[40,2,14,0],[41,2,16,7],[41,17,16,22,"getOrCreateDeviceId"],[41,36,16,41,"getOrCreateDeviceId"],[41,37,16,41],[41,39,16,61],[42,4,17,2],[42,8,17,6,"deviceId"],[42,16,17,14],[42,19,17,17],[42,25,17,23,"SecureStore"],[42,36,17,34],[42,37,17,35,"getItemAsync"],[42,49,17,47],[42,50,17,48,"DEVICE_ID_KEY"],[42,63,17,61],[42,64,17,62],[43,4,18,2],[43,8,18,6],[43,9,18,7,"deviceId"],[43,17,18,15],[43,19,18,17],[44,6,19,4,"deviceId"],[44,14,19,12],[44,17,19,15,"generateDeviceId"],[44,33,19,31],[44,34,19,32],[44,35,19,33],[45,6,20,4],[45,12,20,10,"SecureStore"],[45,23,20,21],[45,24,20,22,"setItemAsync"],[45,36,20,34],[45,37,20,35,"DEVICE_ID_KEY"],[45,50,20,48],[45,52,20,50,"deviceId"],[45,60,20,58],[45,61,20,59],[46,4,21,2],[47,4,22,2],[47,11,22,9,"deviceId"],[47,19,22,17],[48,2,23,0],[49,2,25,7],[49,17,25,22,"getStoredToken"],[49,31,25,36,"getStoredToken"],[49,32,25,36],[49,34,25,63],[50,4,26,2],[50,11,26,9,"SecureStore"],[50,22,26,20],[50,23,26,21,"getItemAsync"],[50,35,26,33],[50,36,26,34,"TOKEN_KEY"],[50,45,26,43],[50,46,26,44],[51,2,27,0],[52,2,29,7],[52,17,29,22,"getStoredUserId"],[52,32,29,37,"getStoredUserId"],[52,33,29,37],[52,35,29,64],[53,4,30,2],[53,11,30,9,"SecureStore"],[53,22,30,20],[53,23,30,21,"getItemAsync"],[53,35,30,33],[53,36,30,34,"USER_ID_KEY"],[53,47,30,45],[53,48,30,46],[54,2,31,0],[55,2,40,7],[55,17,40,22,"pairDevice"],[55,27,40,32,"pairDevice"],[55,28,40,33,"userId"],[55,34,40,47],[55,36,40,72],[56,4,41,2],[56,10,41,8,"deviceId"],[56,18,41,16],[56,21,41,19],[56,27,41,25,"getOrCreateDeviceId"],[56,46,41,44],[56,47,41,45],[56,48,41,46],[57,4,43,2],[57,10,43,8,"response"],[57,18,43,16],[57,21,43,19],[57,27,43,25,"fetch"],[57,32,43,30],[57,33,43,31],[57,36,43,34,"ENV"],[57,46,43,37],[57,47,43,37,"ENV"],[57,50,43,37],[57,51,43,38,"API_URL"],[57,58,43,45],[57,70,43,57],[57,72,43,59],[58,6,44,4,"method"],[58,12,44,10],[58,14,44,12],[58,20,44,18],[59,6,45,4,"headers"],[59,13,45,11],[59,15,45,13],[60,8,45,15],[60,22,45,29],[60,24,45,31],[61,6,45,50],[61,7,45,51],[62,6,46,4,"body"],[62,10,46,8],[62,12,46,10,"JSON"],[62,16,46,14],[62,17,46,15,"stringify"],[62,26,46,24],[62,27,46,25],[63,8,47,6,"user_id"],[63,15,47,13],[63,17,47,15,"userId"],[63,23,47,21],[64,8,48,6,"device_id"],[64,17,48,15],[64,19,48,17,"deviceId"],[64,27,48,25],[65,8,49,6,"client_version"],[65,22,49,20],[65,24,49,22],[66,6,50,4],[66,7,50,5],[67,4,51,2],[67,5,51,3],[67,6,51,4],[68,4,53,2],[68,8,53,6],[68,9,53,7,"response"],[68,17,53,15],[68,18,53,16,"ok"],[68,20,53,18],[68,22,53,20],[69,6,54,4],[69,12,54,10,"text"],[69,16,54,14],[69,19,54,17],[69,25,54,23,"response"],[69,33,54,31],[69,34,54,32,"text"],[69,38,54,36],[69,39,54,37],[69,40,54,38],[70,6,55,4],[70,12,55,10],[70,16,55,14,"Error"],[70,21,55,19],[70,22,55,20],[70,41,55,39,"response"],[70,49,55,47],[70,50,55,48,"status"],[70,56,55,54],[70,60,55,58,"text"],[70,64,55,62],[70,66,55,64],[70,67,55,65],[71,4,56,2],[72,4,58,2],[72,10,58,8,"data"],[72,14,58,26],[72,17,58,29],[72,23,58,35,"response"],[72,31,58,43],[72,32,58,44,"json"],[72,36,58,48],[72,37,58,49],[72,38,58,50],[74,4,60,2],[75,4,61,2],[75,10,61,8,"SecureStore"],[75,21,61,19],[75,22,61,20,"setItemAsync"],[75,34,61,32],[75,35,61,33,"TOKEN_KEY"],[75,44,61,42],[75,46,61,44,"data"],[75,50,61,48],[75,51,61,49,"token"],[75,56,61,54],[75,57,61,55],[76,4,62,2],[76,10,62,8,"SecureStore"],[76,21,62,19],[76,22,62,20,"setItemAsync"],[76,34,62,32],[76,35,62,33,"USER_ID_KEY"],[76,46,62,44],[76,48,62,46,"data"],[76,52,62,50],[76,53,62,51,"user_id"],[76,60,62,58],[76,61,62,59],[77,4,64,2],[77,11,64,9,"data"],[77,15,64,13],[78,2,65,0],[79,2,67,7],[79,17,67,22,"clearAuth"],[79,26,67,31,"clearAuth"],[79,27,67,31],[79,29,67,49],[80,4,68,2],[80,10,68,8,"SecureStore"],[80,21,68,19],[80,22,68,20,"deleteItemAsync"],[80,37,68,35],[80,38,68,36,"TOKEN_KEY"],[80,47,68,45],[80,48,68,46],[81,4,69,2],[81,10,69,8,"SecureStore"],[81,21,69,19],[81,22,69,20,"deleteItemAsync"],[81,37,69,35],[81,38,69,36,"USER_ID_KEY"],[81,49,69,47],[81,50,69,48],[82,2,70,0],[83,0,70,1],[83,3]],"functionMap":{"names":["<global>","generateDeviceId","getOrCreateDeviceId","getStoredToken","getStoredUserId","pairDevice","clearAuth"],"mappings":"AAA;ACU;CDG;OEE;CFO;OGE;CHE;OIE;CJE;OKS;CLyB;OME;CNG"},"hasCjsExports":false},"type":"js/module"}]}