{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":389},"end":{"line":13,"column":33,"index":422}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"useAudioStore\", {\n    enumerable: true,\n    get: function () {\n      return useAudioStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  /**\n   * Audio State Machine — controls the voice interaction lifecycle.\n   *\n   * Spec §3.5 locked FSM:\n   *   IDLE → LISTENING → CAPTURING → COMMITTING → THINKING → RESPONDING → IDLE\n   *\n   * COMMITTING is the ONLY state where:\n   *   - Recorder stops\n   *   - stream_end is sent to server\n   *   - Final user utterance buffer is frozen\n   *   - Transition to THINKING occurs after server acknowledges\n   */\n\n  // Valid transitions per spec §3.5\n  var VALID_TRANSITIONS = {\n    IDLE: ['LISTENING'],\n    LISTENING: ['CAPTURING', 'IDLE'],\n    CAPTURING: ['COMMITTING', 'IDLE'],\n    // CAPTURING → COMMITTING only (no direct THINKING)\n    COMMITTING: ['THINKING', 'IDLE'],\n    // COMMITTING → THINKING after stream_end acknowledged\n    THINKING: ['RESPONDING', 'IDLE', 'LISTENING'],\n    RESPONDING: ['LISTENING', 'IDLE', 'CAPTURING']\n  };\n  var useAudioStore = (0, _zustand.create)((set, get) => ({\n    state: 'IDLE',\n    transcript: '',\n    partialTranscript: '',\n    ttsText: '',\n    isSpeaking: false,\n    chunksSent: 0,\n    vadActive: false,\n    vadEnergy: 0,\n    error: null,\n    transition: to => {\n      var current = get().state;\n      var valid = VALID_TRANSITIONS[current];\n      if (valid.includes(to)) {\n        set({\n          state: to,\n          error: null\n        });\n        return true;\n      }\n      console.warn(`[AudioFSM] Invalid transition: ${current} \\u2192 ${to}`);\n      return false;\n    },\n    setTranscript: text => set({\n      transcript: text\n    }),\n    setPartialTranscript: text => set({\n      partialTranscript: text\n    }),\n    setTtsText: text => set({\n      ttsText: text\n    }),\n    setIsSpeaking: speaking => set({\n      isSpeaking: speaking\n    }),\n    incrementChunks: () => set(s => ({\n      chunksSent: s.chunksSent + 1\n    })),\n    setVadActive: active => set({\n      vadActive: active\n    }),\n    setVadEnergy: energy => set({\n      vadEnergy: energy\n    }),\n    setError: error => set({\n      error\n    }),\n    reset: () => set({\n      state: 'IDLE',\n      transcript: '',\n      partialTranscript: '',\n      ttsText: '',\n      isSpeaking: false,\n      chunksSent: 0,\n      vadActive: false,\n      vadEnergy: 0,\n      error: null\n    })\n  }));\n});","lineCount":97,"map":[[7,2,56,0,"Object"],[7,8,56,0],[7,9,56,0,"defineProperty"],[7,23,56,0],[7,24,56,0,"exports"],[7,31,56,0],[8,4,56,0,"enumerable"],[8,14,56,0],[9,4,56,0,"get"],[9,7,56,0],[9,18,56,0,"get"],[9,19,56,0],[10,6,56,0],[10,13,56,0,"useAudioStore"],[10,26,56,0],[11,4,56,0],[12,2,56,0],[13,2,13,0],[13,6,13,0,"_zustand"],[13,14,13,0],[13,17,13,0,"require"],[13,24,13,0],[13,25,13,0,"_dependencyMap"],[13,39,13,0],[14,2,1,0],[15,0,2,0],[16,0,3,0],[17,0,4,0],[18,0,5,0],[19,0,6,0],[20,0,7,0],[21,0,8,0],[22,0,9,0],[23,0,10,0],[24,0,11,0],[25,0,12,0],[27,2,23,0],[28,2,24,0],[28,6,24,6,"VALID_TRANSITIONS"],[28,23,24,57],[28,26,24,60],[29,4,25,2,"IDLE"],[29,8,25,6],[29,10,25,14],[29,11,25,15],[29,22,25,26],[29,23,25,27],[30,4,26,2,"LISTENING"],[30,13,26,11],[30,15,26,14],[30,16,26,15],[30,27,26,26],[30,29,26,28],[30,35,26,34],[30,36,26,35],[31,4,27,2,"CAPTURING"],[31,13,27,11],[31,15,27,14],[31,16,27,15],[31,28,27,27],[31,30,27,29],[31,36,27,35],[31,37,27,36],[32,4,27,47],[33,4,28,2,"COMMITTING"],[33,14,28,12],[33,16,28,14],[33,17,28,15],[33,27,28,25],[33,29,28,27],[33,35,28,33],[33,36,28,34],[34,4,28,48],[35,4,29,2,"THINKING"],[35,12,29,10],[35,14,29,14],[35,15,29,15],[35,27,29,27],[35,29,29,29],[35,35,29,35],[35,37,29,37],[35,48,29,48],[35,49,29,49],[36,4,30,2,"RESPONDING"],[36,14,30,12],[36,16,30,14],[36,17,30,15],[36,28,30,26],[36,30,30,28],[36,36,30,34],[36,38,30,36],[36,49,30,47],[37,2,31,0],[37,3,31,1],[38,2,56,7],[38,6,56,13,"useAudioStore"],[38,19,56,26],[38,22,56,29],[38,26,56,29,"create"],[38,34,56,35],[38,35,56,35,"create"],[38,41,56,35],[38,43,56,48],[38,44,56,49,"set"],[38,47,56,52],[38,49,56,54,"get"],[38,52,56,57],[38,58,56,63],[39,4,57,2,"state"],[39,9,57,7],[39,11,57,9],[39,17,57,15],[40,4,58,2,"transcript"],[40,14,58,12],[40,16,58,14],[40,18,58,16],[41,4,59,2,"partialTranscript"],[41,21,59,19],[41,23,59,21],[41,25,59,23],[42,4,60,2,"ttsText"],[42,11,60,9],[42,13,60,11],[42,15,60,13],[43,4,61,2,"isSpeaking"],[43,14,61,12],[43,16,61,14],[43,21,61,19],[44,4,62,2,"chunksSent"],[44,14,62,12],[44,16,62,14],[44,17,62,15],[45,4,63,2,"vadActive"],[45,13,63,11],[45,15,63,13],[45,20,63,18],[46,4,64,2,"vadEnergy"],[46,13,64,11],[46,15,64,13],[46,16,64,14],[47,4,65,2,"error"],[47,9,65,7],[47,11,65,9],[47,15,65,13],[48,4,67,2,"transition"],[48,14,67,12],[48,16,67,15,"to"],[48,18,67,29],[48,22,67,34],[49,6,68,4],[49,10,68,10,"current"],[49,17,68,17],[49,20,68,20,"get"],[49,23,68,23],[49,24,68,24],[49,25,68,25],[49,26,68,26,"state"],[49,31,68,31],[50,6,69,4],[50,10,69,10,"valid"],[50,15,69,15],[50,18,69,18,"VALID_TRANSITIONS"],[50,35,69,35],[50,36,69,36,"current"],[50,43,69,43],[50,44,69,44],[51,6,70,4],[51,10,70,8,"valid"],[51,15,70,13],[51,16,70,14,"includes"],[51,24,70,22],[51,25,70,23,"to"],[51,27,70,25],[51,28,70,26],[51,30,70,28],[52,8,71,6,"set"],[52,11,71,9],[52,12,71,10],[53,10,71,12,"state"],[53,15,71,17],[53,17,71,19,"to"],[53,19,71,21],[54,10,71,23,"error"],[54,15,71,28],[54,17,71,30],[55,8,71,35],[55,9,71,36],[55,10,71,37],[56,8,72,6],[56,15,72,13],[56,19,72,17],[57,6,73,4],[58,6,74,4,"console"],[58,13,74,11],[58,14,74,12,"warn"],[58,18,74,16],[58,19,74,17],[58,53,74,51,"current"],[58,60,74,58],[58,71,74,69,"to"],[58,73,74,71],[58,75,74,73],[58,76,74,74],[59,6,75,4],[59,13,75,11],[59,18,75,16],[60,4,76,2],[60,5,76,3],[61,4,78,2,"setTranscript"],[61,17,78,15],[61,19,78,18,"text"],[61,23,78,22],[61,27,78,27,"set"],[61,30,78,30],[61,31,78,31],[62,6,78,33,"transcript"],[62,16,78,43],[62,18,78,45,"text"],[63,4,78,50],[63,5,78,51],[63,6,78,52],[64,4,79,2,"setPartialTranscript"],[64,24,79,22],[64,26,79,25,"text"],[64,30,79,29],[64,34,79,34,"set"],[64,37,79,37],[64,38,79,38],[65,6,79,40,"partialTranscript"],[65,23,79,57],[65,25,79,59,"text"],[66,4,79,64],[66,5,79,65],[66,6,79,66],[67,4,80,2,"setTtsText"],[67,14,80,12],[67,16,80,15,"text"],[67,20,80,19],[67,24,80,24,"set"],[67,27,80,27],[67,28,80,28],[68,6,80,30,"ttsText"],[68,13,80,37],[68,15,80,39,"text"],[69,4,80,44],[69,5,80,45],[69,6,80,46],[70,4,81,2,"setIsSpeaking"],[70,17,81,15],[70,19,81,18,"speaking"],[70,27,81,26],[70,31,81,31,"set"],[70,34,81,34],[70,35,81,35],[71,6,81,37,"isSpeaking"],[71,16,81,47],[71,18,81,49,"speaking"],[72,4,81,58],[72,5,81,59],[72,6,81,60],[73,4,82,2,"incrementChunks"],[73,19,82,17],[73,21,82,19,"incrementChunks"],[73,22,82,19],[73,27,82,25,"set"],[73,30,82,28],[73,31,82,30,"s"],[73,32,82,31],[73,37,82,37],[74,6,82,39,"chunksSent"],[74,16,82,49],[74,18,82,51,"s"],[74,19,82,52],[74,20,82,53,"chunksSent"],[74,30,82,63],[74,33,82,66],[75,4,82,68],[75,5,82,69],[75,6,82,70],[75,7,82,71],[76,4,83,2,"setVadActive"],[76,16,83,14],[76,18,83,17,"active"],[76,24,83,23],[76,28,83,28,"set"],[76,31,83,31],[76,32,83,32],[77,6,83,34,"vadActive"],[77,15,83,43],[77,17,83,45,"active"],[78,4,83,52],[78,5,83,53],[78,6,83,54],[79,4,84,2,"setVadEnergy"],[79,16,84,14],[79,18,84,17,"energy"],[79,24,84,23],[79,28,84,28,"set"],[79,31,84,31],[79,32,84,32],[80,6,84,34,"vadEnergy"],[80,15,84,43],[80,17,84,45,"energy"],[81,4,84,52],[81,5,84,53],[81,6,84,54],[82,4,85,2,"setError"],[82,12,85,10],[82,14,85,13,"error"],[82,19,85,18],[82,23,85,23,"set"],[82,26,85,26],[82,27,85,27],[83,6,85,29,"error"],[84,4,85,35],[84,5,85,36],[84,6,85,37],[85,4,86,2,"reset"],[85,9,86,7],[85,11,86,9,"reset"],[85,12,86,9],[85,17,86,15,"set"],[85,20,86,18],[85,21,86,19],[86,6,87,4,"state"],[86,11,87,9],[86,13,87,11],[86,19,87,17],[87,6,88,4,"transcript"],[87,16,88,14],[87,18,88,16],[87,20,88,18],[88,6,89,4,"partialTranscript"],[88,23,89,21],[88,25,89,23],[88,27,89,25],[89,6,90,4,"ttsText"],[89,13,90,11],[89,15,90,13],[89,17,90,15],[90,6,91,4,"isSpeaking"],[90,16,91,14],[90,18,91,16],[90,23,91,21],[91,6,92,4,"chunksSent"],[91,16,92,14],[91,18,92,16],[91,19,92,17],[92,6,93,4,"vadActive"],[92,15,93,13],[92,17,93,15],[92,22,93,20],[93,6,94,4,"vadEnergy"],[93,15,94,13],[93,17,94,15],[93,18,94,16],[94,6,95,4,"error"],[94,11,95,9],[94,13,95,11],[95,4,96,2],[95,5,96,3],[96,2,97,0],[96,3,97,1],[96,4,97,2],[96,5,97,3],[97,0,97,4],[97,3]],"functionMap":{"names":["<global>","create$argument_0","transition","setTranscript","setPartialTranscript","setTtsText","setIsSpeaking","incrementChunks","set$argument_0","setVadActive","setVadEnergy","setError","reset"],"mappings":"AAA;gDCuD;cCW;GDS;iBEE,mCF;wBGC,0CH;cIC,gCJ;iBKC,2CL;mBMC,UC,yCD,CN;gBQC,sCR;gBSC,sCT;YUC,yBV;SWC;IXU;EDC"},"hasCjsExports":false},"type":"js/module"}]}