{"dependencies":[{"name":"../config/env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":264},"end":{"line":11,"column":36,"index":300}}],"key":"RGB4LNLgNgEtjcVNHbEAgFn5Y3M=","exportNames":["*"],"imports":1}},{"name":"./auth","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":12,"column":0,"index":301},"end":{"line":12,"column":61,"index":362}}],"key":"bPsbxvG/upGRzIWg1D65yZCgVZE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"MyndLensWSClient\", {\n    enumerable: true,\n    get: function () {\n      return MyndLensWSClient;\n    }\n  });\n  Object.defineProperty(exports, \"wsClient\", {\n    enumerable: true,\n    get: function () {\n      return wsClient;\n    }\n  });\n  var _configEnv = require(_dependencyMap[0], \"../config/env\");\n  var _auth = require(_dependencyMap[1], \"./auth\");\n  /**\n   * WebSocket client — connects to MyndLens BE with auth.\n   *\n   * Protocol:\n   * 1. Connect to WS endpoint\n   * 2. Send AUTH message with token + device_id\n   * 3. Receive AUTH_OK with session_id\n   * 4. Start heartbeat loop\n   * 5. Route incoming messages to handlers\n   */\n\n  class MyndLensWSClient {\n    ws = null;\n    sessionId = null;\n    handlers = new Map();\n    heartbeatTimer = null;\n    heartbeatSeq = 0;\n    _isConnected = false;\n    _isAuthenticated = false;\n    _userId = null;\n    get isConnected() {\n      return this._isConnected;\n    }\n    get isAuthenticated() {\n      return this._isAuthenticated;\n    }\n    get currentSessionId() {\n      return this.sessionId;\n    }\n    get userId() {\n      return this._userId;\n    }\n\n    /**\n     * Register a handler for a specific message type.\n     */\n    on(type, handler) {\n      const existing = this.handlers.get(type) || [];\n      existing.push(handler);\n      this.handlers.set(type, existing);\n      // Return unsubscribe function\n      return () => {\n        const handlers = this.handlers.get(type) || [];\n        const idx = handlers.indexOf(handler);\n        if (idx >= 0) handlers.splice(idx, 1);\n      };\n    }\n\n    /**\n     * Connect to the WebSocket server.\n     */\n    async connect() {\n      if (this.ws) {\n        this.disconnect();\n      }\n      return new Promise(async (resolve, reject) => {\n        try {\n          const token = await (0, _auth.getStoredToken)();\n          if (!token) {\n            reject(new Error('No auth token available. Pair device first.'));\n            return;\n          }\n          const deviceId = await (0, _auth.getOrCreateDeviceId)();\n          const wsUrl = _configEnv.ENV.WS_URL;\n          console.log('[WS] Connecting to', wsUrl);\n          this.ws = new WebSocket(wsUrl);\n          this.ws.onopen = () => {\n            console.log('[WS] Connected, sending AUTH');\n            this._isConnected = true;\n            this.reconnectAttempts = 0;\n\n            // Send AUTH message\n            this.send('auth', {\n              token,\n              device_id: deviceId,\n              client_version: '1.0.0'\n            });\n          };\n          this.ws.onmessage = event => {\n            try {\n              const envelope = JSON.parse(event.data);\n              this._routeMessage(envelope, resolve, reject);\n            } catch (err) {\n              console.error('[WS] Failed to parse message:', err);\n            }\n          };\n          this.ws.onclose = event => {\n            console.log('[WS] Closed:', event.code, event.reason);\n            this._cleanup();\n            this._dispatch('session_terminated', {\n              type: 'session_terminated',\n              id: '',\n              timestamp: new Date().toISOString(),\n              payload: {\n                code: event.code,\n                reason: event.reason\n              }\n            });\n            // Auto-reconnect is intentionally NOT here.\n            // loading.tsx is the single authority for reconnection.\n            // Dual reconnect (here + loading.tsx) causes race conditions and stuck states.\n          };\n          this.ws.onerror = error => {\n            console.warn('[WS] Connection error (non-fatal):', error?.type || 'unknown');\n            // Don't reject - let onclose handle reconnection\n          };\n        } catch (err) {\n          reject(err);\n        }\n      });\n    }\n\n    /**\n     * Send a typed message to the server.\n     */\n    send(type, payload = {}) {\n      if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n        console.warn('[WS] Cannot send, not connected');\n        return;\n      }\n      const envelope = {\n        type,\n        id: Math.random().toString(36).substring(2),\n        timestamp: new Date().toISOString(),\n        payload\n      };\n      this.ws.send(JSON.stringify(envelope));\n    }\n\n    /**\n     * Send an execute request (with presence gate on server).\n     */\n    sendExecuteRequest(draftId, touchToken) {\n      this.send('execute_request', {\n        session_id: this.sessionId,\n        draft_id: draftId,\n        touch_token: touchToken || null\n      });\n    }\n\n    /**\n     * Disconnect and cleanup.\n     */\n    disconnect() {\n      if (this.ws) {\n        this.ws.close(1000, 'Client disconnect');\n      }\n      this._cleanup();\n    }\n\n    // ---- Private ----\n\n    _routeMessage(envelope, resolve, reject) {\n      const {\n        type\n      } = envelope;\n      switch (type) {\n        case 'auth_ok':\n          this.sessionId = envelope.payload.session_id;\n          this._userId = envelope.payload.user_id;\n          this._isAuthenticated = true;\n          this._startHeartbeat(envelope.payload.heartbeat_interval_ms || _configEnv.ENV.HEARTBEAT_INTERVAL_MS);\n          console.log('[WS] Authenticated, session:', this.sessionId);\n          resolve?.();\n          break;\n        case 'auth_fail':\n          console.error('[WS] Auth failed:', envelope.payload.reason);\n          this._isAuthenticated = false;\n          reject?.(new Error(envelope.payload.reason));\n          break;\n        case 'heartbeat_ack':\n          // Heartbeat acknowledged — no action needed\n          break;\n        default:\n          break;\n      }\n\n      // Dispatch to registered handlers\n      this._dispatch(type, envelope);\n    }\n    _dispatch(type, envelope) {\n      const handlers = this.handlers.get(type) || [];\n      for (const handler of handlers) {\n        try {\n          handler(envelope);\n        } catch (err) {\n          console.error(`[WS] Handler error for ${type}:`, err);\n        }\n      }\n    }\n    _startHeartbeat(intervalMs) {\n      this._stopHeartbeat();\n      this.heartbeatSeq = 0;\n      this.heartbeatTimer = setInterval(() => {\n        if (this.ws && this.ws.readyState === WebSocket.OPEN && this.sessionId) {\n          this.heartbeatSeq++;\n          this.send('heartbeat', {\n            session_id: this.sessionId,\n            seq: this.heartbeatSeq,\n            client_ts: new Date().toISOString()\n          });\n        }\n      }, intervalMs);\n      console.log(`[WS] Heartbeat started: ${intervalMs}ms interval`);\n    }\n    _stopHeartbeat() {\n      if (this.heartbeatTimer) {\n        clearInterval(this.heartbeatTimer);\n        this.heartbeatTimer = null;\n      }\n    }\n    _cleanup() {\n      this._stopHeartbeat();\n      this._isConnected = false;\n      this._isAuthenticated = false;\n      this.sessionId = null;\n      this.ws = null;\n    }\n  }\n\n  // Singleton instance\n  const wsClient = new MyndLensWSClient();\n});","lineCount":243,"map":[[7,2,31,0,"Object"],[7,8,31,0],[7,9,31,0,"defineProperty"],[7,23,31,0],[7,24,31,0,"exports"],[7,31,31,0],[8,4,31,0,"enumerable"],[8,14,31,0],[9,4,31,0,"get"],[9,7,31,0],[9,18,31,0,"get"],[9,19,31,0],[10,6,31,0],[10,13,31,0,"MyndLensWSClient"],[10,29,31,0],[11,4,31,0],[12,2,31,0],[13,2,249,0,"Object"],[13,8,249,0],[13,9,249,0,"defineProperty"],[13,23,249,0],[13,24,249,0,"exports"],[13,31,249,0],[14,4,249,0,"enumerable"],[14,14,249,0],[15,4,249,0,"get"],[15,7,249,0],[15,18,249,0,"get"],[15,19,249,0],[16,6,249,0],[16,13,249,0,"wsClient"],[16,21,249,0],[17,4,249,0],[18,2,249,0],[19,2,11,0],[19,6,11,0,"_configEnv"],[19,16,11,0],[19,19,11,0,"require"],[19,26,11,0],[19,27,11,0,"_dependencyMap"],[19,41,11,0],[20,2,12,0],[20,6,12,0,"_auth"],[20,11,12,0],[20,14,12,0,"require"],[20,21,12,0],[20,22,12,0,"_dependencyMap"],[20,36,12,0],[21,2,1,0],[22,0,2,0],[23,0,3,0],[24,0,4,0],[25,0,5,0],[26,0,6,0],[27,0,7,0],[28,0,8,0],[29,0,9,0],[30,0,10,0],[32,2,31,7],[32,8,31,13,"MyndLensWSClient"],[32,24,31,29],[32,25,31,30],[33,4,32,10,"ws"],[33,6,32,12],[33,9,32,33],[33,13,32,37],[34,4,33,10,"sessionId"],[34,13,33,19],[34,16,33,37],[34,20,33,41],[35,4,34,10,"handlers"],[35,12,34,18],[35,15,34,61],[35,19,34,65,"Map"],[35,22,34,68],[35,23,34,69],[35,24,34,70],[36,4,35,10,"heartbeatTimer"],[36,18,35,24],[36,21,35,66],[36,25,35,70],[37,4,36,10,"heartbeatSeq"],[37,16,36,22],[37,19,36,33],[37,20,36,34],[38,4,37,10,"_isConnected"],[38,16,37,22],[38,19,37,34],[38,24,37,39],[39,4,38,10,"_isAuthenticated"],[39,20,38,26],[39,23,38,38],[39,28,38,43],[40,4,39,10,"_userId"],[40,11,39,17],[40,14,39,35],[40,18,39,39],[41,4,41,2],[41,8,41,6,"isConnected"],[41,19,41,17,"isConnected"],[41,20,41,17],[41,22,41,29],[42,6,41,31],[42,13,41,38],[42,17,41,42],[42,18,41,43,"_isConnected"],[42,30,41,55],[43,4,41,57],[44,4,42,2],[44,8,42,6,"isAuthenticated"],[44,23,42,21,"isAuthenticated"],[44,24,42,21],[44,26,42,33],[45,6,42,35],[45,13,42,42],[45,17,42,46],[45,18,42,47,"_isAuthenticated"],[45,34,42,63],[46,4,42,65],[47,4,43,2],[47,8,43,6,"currentSessionId"],[47,24,43,22,"currentSessionId"],[47,25,43,22],[47,27,43,40],[48,6,43,42],[48,13,43,49],[48,17,43,53],[48,18,43,54,"sessionId"],[48,27,43,63],[49,4,43,65],[50,4,44,2],[50,8,44,6,"userId"],[50,14,44,12,"userId"],[50,15,44,12],[50,17,44,30],[51,6,44,32],[51,13,44,39],[51,17,44,43],[51,18,44,44,"_userId"],[51,25,44,51],[52,4,44,53],[54,4,46,2],[55,0,47,0],[56,0,48,0],[57,4,49,2,"on"],[57,6,49,4,"on"],[57,7,49,5,"type"],[57,11,49,24],[57,13,49,26,"handler"],[57,20,49,51],[57,22,49,65],[58,6,50,4],[58,12,50,10,"existing"],[58,20,50,18],[58,23,50,21],[58,27,50,25],[58,28,50,26,"handlers"],[58,36,50,34],[58,37,50,35,"get"],[58,40,50,38],[58,41,50,39,"type"],[58,45,50,43],[58,46,50,44],[58,50,50,48],[58,52,50,50],[59,6,51,4,"existing"],[59,14,51,12],[59,15,51,13,"push"],[59,19,51,17],[59,20,51,18,"handler"],[59,27,51,25],[59,28,51,26],[60,6,52,4],[60,10,52,8],[60,11,52,9,"handlers"],[60,19,52,17],[60,20,52,18,"set"],[60,23,52,21],[60,24,52,22,"type"],[60,28,52,26],[60,30,52,28,"existing"],[60,38,52,36],[60,39,52,37],[61,6,53,4],[62,6,54,4],[62,13,54,11],[62,19,54,17],[63,8,55,6],[63,14,55,12,"handlers"],[63,22,55,20],[63,25,55,23],[63,29,55,27],[63,30,55,28,"handlers"],[63,38,55,36],[63,39,55,37,"get"],[63,42,55,40],[63,43,55,41,"type"],[63,47,55,45],[63,48,55,46],[63,52,55,50],[63,54,55,52],[64,8,56,6],[64,14,56,12,"idx"],[64,17,56,15],[64,20,56,18,"handlers"],[64,28,56,26],[64,29,56,27,"indexOf"],[64,36,56,34],[64,37,56,35,"handler"],[64,44,56,42],[64,45,56,43],[65,8,57,6],[65,12,57,10,"idx"],[65,15,57,13],[65,19,57,17],[65,20,57,18],[65,22,57,20,"handlers"],[65,30,57,28],[65,31,57,29,"splice"],[65,37,57,35],[65,38,57,36,"idx"],[65,41,57,39],[65,43,57,41],[65,44,57,42],[65,45,57,43],[66,6,58,4],[66,7,58,5],[67,4,59,2],[69,4,61,2],[70,0,62,0],[71,0,63,0],[72,4,64,2],[72,10,64,8,"connect"],[72,17,64,15,"connect"],[72,18,64,15],[72,20,64,33],[73,6,65,4],[73,10,65,8],[73,14,65,12],[73,15,65,13,"ws"],[73,17,65,15],[73,19,65,17],[74,8,66,6],[74,12,66,10],[74,13,66,11,"disconnect"],[74,23,66,21],[74,24,66,22],[74,25,66,23],[75,6,67,4],[76,6,69,4],[76,13,69,11],[76,17,69,15,"Promise"],[76,24,69,22],[76,25,69,23],[76,32,69,30,"resolve"],[76,39,69,37],[76,41,69,39,"reject"],[76,47,69,45],[76,52,69,50],[77,8,70,6],[77,12,70,10],[78,10,71,8],[78,16,71,14,"token"],[78,21,71,19],[78,24,71,22],[78,30,71,28],[78,34,71,28,"getStoredToken"],[78,39,71,42],[78,40,71,42,"getStoredToken"],[78,54,71,42],[78,56,71,43],[78,57,71,44],[79,10,72,8],[79,14,72,12],[79,15,72,13,"token"],[79,20,72,18],[79,22,72,20],[80,12,73,10,"reject"],[80,18,73,16],[80,19,73,17],[80,23,73,21,"Error"],[80,28,73,26],[80,29,73,27],[80,74,73,72],[80,75,73,73],[80,76,73,74],[81,12,74,10],[82,10,75,8],[83,10,77,8],[83,16,77,14,"deviceId"],[83,24,77,22],[83,27,77,25],[83,33,77,31],[83,37,77,31,"getOrCreateDeviceId"],[83,42,77,50],[83,43,77,50,"getOrCreateDeviceId"],[83,62,77,50],[83,64,77,51],[83,65,77,52],[84,10,78,8],[84,16,78,14,"wsUrl"],[84,21,78,19],[84,24,78,22,"ENV"],[84,34,78,25],[84,35,78,25,"ENV"],[84,38,78,25],[84,39,78,26,"WS_URL"],[84,45,78,32],[85,10,80,8,"console"],[85,17,80,15],[85,18,80,16,"log"],[85,21,80,19],[85,22,80,20],[85,42,80,40],[85,44,80,42,"wsUrl"],[85,49,80,47],[85,50,80,48],[86,10,81,8],[86,14,81,12],[86,15,81,13,"ws"],[86,17,81,15],[86,20,81,18],[86,24,81,22,"WebSocket"],[86,33,81,31],[86,34,81,32,"wsUrl"],[86,39,81,37],[86,40,81,38],[87,10,83,8],[87,14,83,12],[87,15,83,13,"ws"],[87,17,83,15],[87,18,83,16,"onopen"],[87,24,83,22],[87,27,83,25],[87,33,83,31],[88,12,84,10,"console"],[88,19,84,17],[88,20,84,18,"log"],[88,23,84,21],[88,24,84,22],[88,54,84,52],[88,55,84,53],[89,12,85,10],[89,16,85,14],[89,17,85,15,"_isConnected"],[89,29,85,27],[89,32,85,30],[89,36,85,34],[90,12,86,10],[90,16,86,14],[90,17,86,15,"reconnectAttempts"],[90,34,86,32],[90,37,86,35],[90,38,86,36],[92,12,88,10],[93,12,89,10],[93,16,89,14],[93,17,89,15,"send"],[93,21,89,19],[93,22,89,20],[93,28,89,26],[93,30,89,28],[94,14,90,12,"token"],[94,19,90,17],[95,14,91,12,"device_id"],[95,23,91,21],[95,25,91,23,"deviceId"],[95,33,91,31],[96,14,92,12,"client_version"],[96,28,92,26],[96,30,92,28],[97,12,93,10],[97,13,93,11],[97,14,93,12],[98,10,94,8],[98,11,94,9],[99,10,96,8],[99,14,96,12],[99,15,96,13,"ws"],[99,17,96,15],[99,18,96,16,"onmessage"],[99,27,96,25],[99,30,96,29,"event"],[99,35,96,34],[99,39,96,39],[100,12,97,10],[100,16,97,14],[101,14,98,12],[101,20,98,18,"envelope"],[101,28,98,38],[101,31,98,41,"JSON"],[101,35,98,45],[101,36,98,46,"parse"],[101,41,98,51],[101,42,98,52,"event"],[101,47,98,57],[101,48,98,58,"data"],[101,52,98,62],[101,53,98,63],[102,14,99,12],[102,18,99,16],[102,19,99,17,"_routeMessage"],[102,32,99,30],[102,33,99,31,"envelope"],[102,41,99,39],[102,43,99,41,"resolve"],[102,50,99,48],[102,52,99,50,"reject"],[102,58,99,56],[102,59,99,57],[103,12,100,10],[103,13,100,11],[103,14,100,12],[103,21,100,19,"err"],[103,24,100,22],[103,26,100,24],[104,14,101,12,"console"],[104,21,101,19],[104,22,101,20,"error"],[104,27,101,25],[104,28,101,26],[104,59,101,57],[104,61,101,59,"err"],[104,64,101,62],[104,65,101,63],[105,12,102,10],[106,10,103,8],[106,11,103,9],[107,10,105,8],[107,14,105,12],[107,15,105,13,"ws"],[107,17,105,15],[107,18,105,16,"onclose"],[107,25,105,23],[107,28,105,27,"event"],[107,33,105,32],[107,37,105,37],[108,12,106,10,"console"],[108,19,106,17],[108,20,106,18,"log"],[108,23,106,21],[108,24,106,22],[108,38,106,36],[108,40,106,38,"event"],[108,45,106,43],[108,46,106,44,"code"],[108,50,106,48],[108,52,106,50,"event"],[108,57,106,55],[108,58,106,56,"reason"],[108,64,106,62],[108,65,106,63],[109,12,107,10],[109,16,107,14],[109,17,107,15,"_cleanup"],[109,25,107,23],[109,26,107,24],[109,27,107,25],[110,12,108,10],[110,16,108,14],[110,17,108,15,"_dispatch"],[110,26,108,24],[110,27,108,25],[110,47,108,45],[110,49,108,47],[111,14,109,12,"type"],[111,18,109,16],[111,20,109,18],[111,40,109,38],[112,14,110,12,"id"],[112,16,110,14],[112,18,110,16],[112,20,110,18],[113,14,111,12,"timestamp"],[113,23,111,21],[113,25,111,23],[113,29,111,27,"Date"],[113,33,111,31],[113,34,111,32],[113,35,111,33],[113,36,111,34,"toISOString"],[113,47,111,45],[113,48,111,46],[113,49,111,47],[114,14,112,12,"payload"],[114,21,112,19],[114,23,112,21],[115,16,112,23,"code"],[115,20,112,27],[115,22,112,29,"event"],[115,27,112,34],[115,28,112,35,"code"],[115,32,112,39],[116,16,112,41,"reason"],[116,22,112,47],[116,24,112,49,"event"],[116,29,112,54],[116,30,112,55,"reason"],[117,14,112,62],[118,12,113,10],[118,13,113,11],[118,14,113,12],[119,12,114,10],[120,12,115,10],[121,12,116,10],[122,10,117,8],[122,11,117,9],[123,10,119,8],[123,14,119,12],[123,15,119,13,"ws"],[123,17,119,15],[123,18,119,16,"onerror"],[123,25,119,23],[123,28,119,27,"error"],[123,33,119,32],[123,37,119,37],[124,12,120,10,"console"],[124,19,120,17],[124,20,120,18,"warn"],[124,24,120,22],[124,25,120,23],[124,61,120,59],[124,63,120,61,"error"],[124,68,120,66],[124,70,120,68,"type"],[124,74,120,72],[124,78,120,76],[124,87,120,85],[124,88,120,86],[125,12,121,10],[126,10,122,8],[126,11,122,9],[127,8,124,6],[127,9,124,7],[127,10,124,8],[127,17,124,15,"err"],[127,20,124,18],[127,22,124,20],[128,10,125,8,"reject"],[128,16,125,14],[128,17,125,15,"err"],[128,20,125,18],[128,21,125,19],[129,8,126,6],[130,6,127,4],[130,7,127,5],[130,8,127,6],[131,4,128,2],[133,4,130,2],[134,0,131,0],[135,0,132,0],[136,4,133,2,"send"],[136,8,133,6,"send"],[136,9,133,7,"type"],[136,13,133,26],[136,15,133,28,"payload"],[136,22,133,56],[136,25,133,59],[136,26,133,60],[136,27,133,61],[136,29,133,69],[137,6,134,4],[137,10,134,8],[137,11,134,9],[137,15,134,13],[137,16,134,14,"ws"],[137,18,134,16],[137,22,134,20],[137,26,134,24],[137,27,134,25,"ws"],[137,29,134,27],[137,30,134,28,"readyState"],[137,40,134,38],[137,45,134,43,"WebSocket"],[137,54,134,52],[137,55,134,53,"OPEN"],[137,59,134,57],[137,61,134,59],[138,8,135,6,"console"],[138,15,135,13],[138,16,135,14,"warn"],[138,20,135,18],[138,21,135,19],[138,54,135,52],[138,55,135,53],[139,8,136,6],[140,6,137,4],[141,6,139,4],[141,12,139,10,"envelope"],[141,20,139,30],[141,23,139,33],[142,8,140,6,"type"],[142,12,140,10],[143,8,141,6,"id"],[143,10,141,8],[143,12,141,10,"Math"],[143,16,141,14],[143,17,141,15,"random"],[143,23,141,21],[143,24,141,22],[143,25,141,23],[143,26,141,24,"toString"],[143,34,141,32],[143,35,141,33],[143,37,141,35],[143,38,141,36],[143,39,141,37,"substring"],[143,48,141,46],[143,49,141,47],[143,50,141,48],[143,51,141,49],[144,8,142,6,"timestamp"],[144,17,142,15],[144,19,142,17],[144,23,142,21,"Date"],[144,27,142,25],[144,28,142,26],[144,29,142,27],[144,30,142,28,"toISOString"],[144,41,142,39],[144,42,142,40],[144,43,142,41],[145,8,143,6,"payload"],[146,6,144,4],[146,7,144,5],[147,6,146,4],[147,10,146,8],[147,11,146,9,"ws"],[147,13,146,11],[147,14,146,12,"send"],[147,18,146,16],[147,19,146,17,"JSON"],[147,23,146,21],[147,24,146,22,"stringify"],[147,33,146,31],[147,34,146,32,"envelope"],[147,42,146,40],[147,43,146,41],[147,44,146,42],[148,4,147,2],[150,4,149,2],[151,0,150,0],[152,0,151,0],[153,4,152,2,"sendExecuteRequest"],[153,22,152,20,"sendExecuteRequest"],[153,23,152,21,"draftId"],[153,30,152,36],[153,32,152,38,"touchToken"],[153,42,152,57],[153,44,152,65],[154,6,153,4],[154,10,153,8],[154,11,153,9,"send"],[154,15,153,13],[154,16,153,14],[154,33,153,31],[154,35,153,33],[155,8,154,6,"session_id"],[155,18,154,16],[155,20,154,18],[155,24,154,22],[155,25,154,23,"sessionId"],[155,34,154,32],[156,8,155,6,"draft_id"],[156,16,155,14],[156,18,155,16,"draftId"],[156,25,155,23],[157,8,156,6,"touch_token"],[157,19,156,17],[157,21,156,19,"touchToken"],[157,31,156,29],[157,35,156,33],[158,6,157,4],[158,7,157,5],[158,8,157,6],[159,4,158,2],[161,4,160,2],[162,0,161,0],[163,0,162,0],[164,4,163,2,"disconnect"],[164,14,163,12,"disconnect"],[164,15,163,12],[164,17,163,21],[165,6,164,4],[165,10,164,8],[165,14,164,12],[165,15,164,13,"ws"],[165,17,164,15],[165,19,164,17],[166,8,165,6],[166,12,165,10],[166,13,165,11,"ws"],[166,15,165,13],[166,16,165,14,"close"],[166,21,165,19],[166,22,165,20],[166,26,165,24],[166,28,165,26],[166,47,165,45],[166,48,165,46],[167,6,166,4],[168,6,167,4],[168,10,167,8],[168,11,167,9,"_cleanup"],[168,19,167,17],[168,20,167,18],[168,21,167,19],[169,4,168,2],[171,4,170,2],[173,4,172,10,"_routeMessage"],[173,17,172,23,"_routeMessage"],[173,18,172,24,"envelope"],[173,26,172,44],[173,28,172,46,"resolve"],[173,35,172,64],[173,37,172,66,"reject"],[173,43,172,83],[173,45,172,91],[174,6,173,4],[174,12,173,10],[175,8,173,12,"type"],[176,6,173,17],[176,7,173,18],[176,10,173,21,"envelope"],[176,18,173,29],[177,6,175,4],[177,14,175,12,"type"],[177,18,175,16],[178,8,176,6],[178,13,176,11],[178,22,176,20],[179,10,177,8],[179,14,177,12],[179,15,177,13,"sessionId"],[179,24,177,22],[179,27,177,25,"envelope"],[179,35,177,33],[179,36,177,34,"payload"],[179,43,177,41],[179,44,177,42,"session_id"],[179,54,177,52],[180,10,178,8],[180,14,178,12],[180,15,178,13,"_userId"],[180,22,178,20],[180,25,178,23,"envelope"],[180,33,178,31],[180,34,178,32,"payload"],[180,41,178,39],[180,42,178,40,"user_id"],[180,49,178,47],[181,10,179,8],[181,14,179,12],[181,15,179,13,"_isAuthenticated"],[181,31,179,29],[181,34,179,32],[181,38,179,36],[182,10,180,8],[182,14,180,12],[182,15,180,13,"_startHeartbeat"],[182,30,180,28],[182,31,180,29,"envelope"],[182,39,180,37],[182,40,180,38,"payload"],[182,47,180,45],[182,48,180,46,"heartbeat_interval_ms"],[182,69,180,67],[182,73,180,71,"ENV"],[182,83,180,74],[182,84,180,74,"ENV"],[182,87,180,74],[182,88,180,75,"HEARTBEAT_INTERVAL_MS"],[182,109,180,96],[182,110,180,97],[183,10,181,8,"console"],[183,17,181,15],[183,18,181,16,"log"],[183,21,181,19],[183,22,181,20],[183,52,181,50],[183,54,181,52],[183,58,181,56],[183,59,181,57,"sessionId"],[183,68,181,66],[183,69,181,67],[184,10,182,8,"resolve"],[184,17,182,15],[184,20,182,18],[184,21,182,19],[185,10,183,8],[186,8,185,6],[186,13,185,11],[186,24,185,22],[187,10,186,8,"console"],[187,17,186,15],[187,18,186,16,"error"],[187,23,186,21],[187,24,186,22],[187,43,186,41],[187,45,186,43,"envelope"],[187,53,186,51],[187,54,186,52,"payload"],[187,61,186,59],[187,62,186,60,"reason"],[187,68,186,66],[187,69,186,67],[188,10,187,8],[188,14,187,12],[188,15,187,13,"_isAuthenticated"],[188,31,187,29],[188,34,187,32],[188,39,187,37],[189,10,188,8,"reject"],[189,16,188,14],[189,19,188,17],[189,23,188,21,"Error"],[189,28,188,26],[189,29,188,27,"envelope"],[189,37,188,35],[189,38,188,36,"payload"],[189,45,188,43],[189,46,188,44,"reason"],[189,52,188,50],[189,53,188,51],[189,54,188,52],[190,10,189,8],[191,8,191,6],[191,13,191,11],[191,28,191,26],[192,10,192,8],[193,10,193,8],[194,8,195,6],[195,10,196,8],[196,6,197,4],[198,6,199,4],[199,6,200,4],[199,10,200,8],[199,11,200,9,"_dispatch"],[199,20,200,18],[199,21,200,19,"type"],[199,25,200,23],[199,27,200,25,"envelope"],[199,35,200,33],[199,36,200,34],[200,4,201,2],[201,4,203,10,"_dispatch"],[201,13,203,19,"_dispatch"],[201,14,203,20,"type"],[201,18,203,39],[201,20,203,41,"envelope"],[201,28,203,61],[201,30,203,69],[202,6,204,4],[202,12,204,10,"handlers"],[202,20,204,18],[202,23,204,21],[202,27,204,25],[202,28,204,26,"handlers"],[202,36,204,34],[202,37,204,35,"get"],[202,40,204,38],[202,41,204,39,"type"],[202,45,204,43],[202,46,204,44],[202,50,204,48],[202,52,204,50],[203,6,205,4],[203,11,205,9],[203,17,205,15,"handler"],[203,24,205,22],[203,28,205,26,"handlers"],[203,36,205,34],[203,38,205,36],[204,8,206,6],[204,12,206,10],[205,10,207,8,"handler"],[205,17,207,15],[205,18,207,16,"envelope"],[205,26,207,24],[205,27,207,25],[206,8,208,6],[206,9,208,7],[206,10,208,8],[206,17,208,15,"err"],[206,20,208,18],[206,22,208,20],[207,10,209,8,"console"],[207,17,209,15],[207,18,209,16,"error"],[207,23,209,21],[207,24,209,22],[207,50,209,48,"type"],[207,54,209,52],[207,57,209,55],[207,59,209,57,"err"],[207,62,209,60],[207,63,209,61],[208,8,210,6],[209,6,211,4],[210,4,212,2],[211,4,214,10,"_startHeartbeat"],[211,19,214,25,"_startHeartbeat"],[211,20,214,26,"intervalMs"],[211,30,214,44],[211,32,214,52],[212,6,215,4],[212,10,215,8],[212,11,215,9,"_stopHeartbeat"],[212,25,215,23],[212,26,215,24],[212,27,215,25],[213,6,216,4],[213,10,216,8],[213,11,216,9,"heartbeatSeq"],[213,23,216,21],[213,26,216,24],[213,27,216,25],[214,6,218,4],[214,10,218,8],[214,11,218,9,"heartbeatTimer"],[214,25,218,23],[214,28,218,26,"setInterval"],[214,39,218,37],[214,40,218,38],[214,46,218,44],[215,8,219,6],[215,12,219,10],[215,16,219,14],[215,17,219,15,"ws"],[215,19,219,17],[215,23,219,21],[215,27,219,25],[215,28,219,26,"ws"],[215,30,219,28],[215,31,219,29,"readyState"],[215,41,219,39],[215,46,219,44,"WebSocket"],[215,55,219,53],[215,56,219,54,"OPEN"],[215,60,219,58],[215,64,219,62],[215,68,219,66],[215,69,219,67,"sessionId"],[215,78,219,76],[215,80,219,78],[216,10,220,8],[216,14,220,12],[216,15,220,13,"heartbeatSeq"],[216,27,220,25],[216,29,220,27],[217,10,221,8],[217,14,221,12],[217,15,221,13,"send"],[217,19,221,17],[217,20,221,18],[217,31,221,29],[217,33,221,31],[218,12,222,10,"session_id"],[218,22,222,20],[218,24,222,22],[218,28,222,26],[218,29,222,27,"sessionId"],[218,38,222,36],[219,12,223,10,"seq"],[219,15,223,13],[219,17,223,15],[219,21,223,19],[219,22,223,20,"heartbeatSeq"],[219,34,223,32],[220,12,224,10,"client_ts"],[220,21,224,19],[220,23,224,21],[220,27,224,25,"Date"],[220,31,224,29],[220,32,224,30],[220,33,224,31],[220,34,224,32,"toISOString"],[220,45,224,43],[220,46,224,44],[221,10,225,8],[221,11,225,9],[221,12,225,10],[222,8,226,6],[223,6,227,4],[223,7,227,5],[223,9,227,7,"intervalMs"],[223,19,227,17],[223,20,227,18],[224,6,229,4,"console"],[224,13,229,11],[224,14,229,12,"log"],[224,17,229,15],[224,18,229,16],[224,45,229,43,"intervalMs"],[224,55,229,53],[224,68,229,66],[224,69,229,67],[225,4,230,2],[226,4,232,10,"_stopHeartbeat"],[226,18,232,24,"_stopHeartbeat"],[226,19,232,24],[226,21,232,33],[227,6,233,4],[227,10,233,8],[227,14,233,12],[227,15,233,13,"heartbeatTimer"],[227,29,233,27],[227,31,233,29],[228,8,234,6,"clearInterval"],[228,21,234,19],[228,22,234,20],[228,26,234,24],[228,27,234,25,"heartbeatTimer"],[228,41,234,39],[228,42,234,40],[229,8,235,6],[229,12,235,10],[229,13,235,11,"heartbeatTimer"],[229,27,235,25],[229,30,235,28],[229,34,235,32],[230,6,236,4],[231,4,237,2],[232,4,239,10,"_cleanup"],[232,12,239,18,"_cleanup"],[232,13,239,18],[232,15,239,27],[233,6,240,4],[233,10,240,8],[233,11,240,9,"_stopHeartbeat"],[233,25,240,23],[233,26,240,24],[233,27,240,25],[234,6,241,4],[234,10,241,8],[234,11,241,9,"_isConnected"],[234,23,241,21],[234,26,241,24],[234,31,241,29],[235,6,242,4],[235,10,242,8],[235,11,242,9,"_isAuthenticated"],[235,27,242,25],[235,30,242,28],[235,35,242,33],[236,6,243,4],[236,10,243,8],[236,11,243,9,"sessionId"],[236,20,243,18],[236,23,243,21],[236,27,243,25],[237,6,244,4],[237,10,244,8],[237,11,244,9,"ws"],[237,13,244,11],[237,16,244,14],[237,20,244,18],[238,4,245,2],[239,2,246,0],[241,2,248,0],[242,2,249,7],[242,8,249,13,"wsClient"],[242,16,249,21],[242,19,249,24],[242,23,249,28,"MyndLensWSClient"],[242,39,249,44],[242,40,249,45],[242,41,249,46],[243,0,249,47],[243,3]],"functionMap":{"names":["<global>","MyndLensWSClient","MyndLensWSClient#get__isConnected","MyndLensWSClient#get__isAuthenticated","MyndLensWSClient#get__currentSessionId","MyndLensWSClient#get__userId","MyndLensWSClient#on","<anonymous>","MyndLensWSClient#connect","Promise$argument_0","ws.onopen","ws.onmessage","ws.onclose","ws.onerror","MyndLensWSClient#send","MyndLensWSClient#sendExecuteRequest","MyndLensWSClient#disconnect","MyndLensWSClient#_routeMessage","MyndLensWSClient#_dispatch","MyndLensWSClient#_startHeartbeat","setInterval$argument_0","MyndLensWSClient#_stopHeartbeat","MyndLensWSClient#_cleanup"],"mappings":"AAA;OC8B;ECU,wDD;EEC,gEF;EGC,gEH;EIC,oDJ;EKK;WCK;KDI;GLC;EOK;uBCK;yBCc;SDW;4BEE;SFO;0BGE;SHY;0BIE;SJG;KDK;GPC;EaK;Gbc;EcK;GdM;EeK;GfK;EgBI;GhB6B;EiBE;GjBS;EkBE;sCCI;KDS;GlBG;EoBE;GpBK;EqBE;GrBM;CDC"},"hasCjsExports":false},"type":"js/module"}]}